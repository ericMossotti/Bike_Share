<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Eric Mossotti">

<title>Bike_Share - BikeShare</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-binding-2.2.1/leaflet.js"></script>
<script src="site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="site_libs/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script>
<link href="site_libs/HomeButton-0.0.1/home-button.css" rel="stylesheet">
<script src="site_libs/HomeButton-0.0.1/home-button.js"></script>
<script src="site_libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="site_libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="site_libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet">
<link href="site_libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet">
<link href="site_libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet">
<script src="site_libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="site_libs/dygraphs-1.1.1/shapes.js"></script>
<script src="site_libs/moment-2.8.4/moment.js"></script>
<script src="site_libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="site_libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="site_libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<script type="ojs-define">
{"contents":[{"name":"js_tsi","value":{"started_at":["2023-01-01","2023-01-01","2023-01-02","2023-01-02","2023-01-03","2023-01-03","2023-01-04","2023-01-04","2023-01-05","2023-01-05","2023-01-06","2023-01-06","2023-01-07","2023-01-07","2023-01-08","2023-01-08","2023-01-09","2023-01-09","2023-01-10","2023-01-10","2023-01-11","2023-01-11","2023-01-12","2023-01-12","2023-01-13","2023-01-13","2023-01-14","2023-01-14","2023-01-15","2023-01-15","2023-01-16","2023-01-16","2023-01-17","2023-01-17","2023-01-18","2023-01-18","2023-01-19","2023-01-19","2023-01-20","2023-01-20","2023-01-21","2023-01-21","2023-01-22","2023-01-22","2023-01-23","2023-01-23","2023-01-24","2023-01-24","2023-01-25","2023-01-25","2023-01-26","2023-01-26","2023-01-27","2023-01-27","2023-01-28","2023-01-28","2023-01-29","2023-01-29","2023-01-30","2023-01-30","2023-01-31","2023-01-31","2023-02-01","2023-02-01","2023-02-02","2023-02-02","2023-02-03","2023-02-03","2023-02-04","2023-02-04","2023-02-05","2023-02-05","2023-02-06","2023-02-06","2023-02-07","2023-02-07","2023-02-08","2023-02-08","2023-02-09","2023-02-09","2023-02-10","2023-02-10","2023-02-11","2023-02-11","2023-02-12","2023-02-12","2023-02-13","2023-02-13","2023-02-14","2023-02-14","2023-02-15","2023-02-15","2023-02-16","2023-02-16","2023-02-17","2023-02-17","2023-02-18","2023-02-18","2023-02-19","2023-02-19","2023-02-20","2023-02-20","2023-02-21","2023-02-21","2023-02-22","2023-02-22","2023-02-23","2023-02-23","2023-02-24","2023-02-24","2023-02-25","2023-02-25","2023-02-26","2023-02-26","2023-02-27","2023-02-27","2023-02-28","2023-02-28","2023-03-01","2023-03-01","2023-03-02","2023-03-02","2023-03-03","2023-03-03","2023-03-04","2023-03-04","2023-03-05","2023-03-05","2023-03-06","2023-03-06","2023-03-07","2023-03-07","2023-03-08","2023-03-08","2023-03-09","2023-03-09","2023-03-10","2023-03-10","2023-03-11","2023-03-11","2023-03-12","2023-03-12","2023-03-13","2023-03-13","2023-03-14","2023-03-14","2023-03-15","2023-03-15","2023-03-16","2023-03-16","2023-03-17","2023-03-17","2023-03-18","2023-03-18","2023-03-19","2023-03-19","2023-03-20","2023-03-20","2023-03-21","2023-03-21","2023-03-22","2023-03-22","2023-03-23","2023-03-23","2023-03-24","2023-03-24","2023-03-25","2023-03-25","2023-03-26","2023-03-26","2023-03-27","2023-03-27","2023-03-28","2023-03-28","2023-03-29","2023-03-29","2023-03-30","2023-03-30","2023-03-31","2023-03-31","2023-04-01","2023-04-01","2023-04-02","2023-04-02","2023-04-03","2023-04-03","2023-04-04","2023-04-04","2023-04-05","2023-04-05","2023-04-06","2023-04-06","2023-04-07","2023-04-07","2023-04-08","2023-04-08","2023-04-09","2023-04-09","2023-04-10","2023-04-10","2023-04-11","2023-04-11","2023-04-12","2023-04-12","2023-04-13","2023-04-13","2023-04-14","2023-04-14","2023-04-15","2023-04-15","2023-04-16","2023-04-16","2023-04-17","2023-04-17","2023-04-18","2023-04-18","2023-04-19","2023-04-19","2023-04-20","2023-04-20","2023-04-21","2023-04-21","2023-04-22","2023-04-22","2023-04-23","2023-04-23","2023-04-24","2023-04-24","2023-04-25","2023-04-25","2023-04-26","2023-04-26","2023-04-27","2023-04-27","2023-04-28","2023-04-28","2023-04-29","2023-04-29","2023-04-30","2023-04-30","2023-05-01","2023-05-01","2023-05-02","2023-05-02","2023-05-03","2023-05-03","2023-05-04","2023-05-04","2023-05-05","2023-05-05","2023-05-06","2023-05-06","2023-05-07","2023-05-07","2023-05-08","2023-05-08","2023-05-09","2023-05-09","2023-05-10","2023-05-10","2023-05-11","2023-05-11","2023-05-12","2023-05-12","2023-05-13","2023-05-13","2023-05-14","2023-05-14","2023-05-15","2023-05-15","2023-05-16","2023-05-16","2023-05-17","2023-05-17","2023-05-18","2023-05-18","2023-05-19","2023-05-19","2023-05-20","2023-05-20","2023-05-21","2023-05-21","2023-05-22","2023-05-22","2023-05-23","2023-05-23","2023-05-24","2023-05-24","2023-05-25","2023-05-25","2023-05-26","2023-05-26","2023-05-27","2023-05-27","2023-05-28","2023-05-28","2023-05-29","2023-05-29","2023-05-30","2023-05-30","2023-05-31","2023-05-31","2023-06-01","2023-06-01","2023-06-02","2023-06-02","2023-06-03","2023-06-03","2023-06-04","2023-06-04","2023-06-05","2023-06-05","2023-06-06","2023-06-06","2023-06-07","2023-06-07","2023-06-08","2023-06-08","2023-06-09","2023-06-09","2023-06-10","2023-06-10","2023-06-11","2023-06-11","2023-06-12","2023-06-12","2023-06-13","2023-06-13","2023-06-14","2023-06-14","2023-06-15","2023-06-15","2023-06-16","2023-06-16","2023-06-17","2023-06-17","2023-06-18","2023-06-18","2023-06-19","2023-06-19","2023-06-20","2023-06-20","2023-06-21","2023-06-21","2023-06-22","2023-06-22","2023-06-23","2023-06-23","2023-06-24","2023-06-24","2023-06-25","2023-06-25","2023-06-26","2023-06-26","2023-06-27","2023-06-27","2023-06-28","2023-06-28","2023-06-29","2023-06-29","2023-06-30","2023-06-30","2023-07-01","2023-07-01","2023-07-02","2023-07-02","2023-07-03","2023-07-03","2023-07-04","2023-07-04","2023-07-05","2023-07-05","2023-07-06","2023-07-06","2023-07-07","2023-07-07","2023-07-08","2023-07-08","2023-07-09","2023-07-09","2023-07-10","2023-07-10","2023-07-11","2023-07-11","2023-07-12","2023-07-12","2023-07-13","2023-07-13","2023-07-14","2023-07-14","2023-07-15","2023-07-15","2023-07-16","2023-07-16","2023-07-17","2023-07-17","2023-07-18","2023-07-18","2023-07-19","2023-07-19","2023-07-20","2023-07-20","2023-07-21","2023-07-21","2023-07-22","2023-07-22","2023-07-23","2023-07-23","2023-07-24","2023-07-24","2023-07-25","2023-07-25","2023-07-26","2023-07-26","2023-07-27","2023-07-27","2023-07-28","2023-07-28","2023-07-29","2023-07-29","2023-07-30","2023-07-30","2023-07-31","2023-07-31","2023-08-01","2023-08-01","2023-08-02","2023-08-02","2023-08-03","2023-08-03","2023-08-04","2023-08-04","2023-08-05","2023-08-05","2023-08-06","2023-08-06","2023-08-07","2023-08-07","2023-08-08","2023-08-08","2023-08-09","2023-08-09","2023-08-10","2023-08-10","2023-08-11","2023-08-11","2023-08-12","2023-08-12","2023-08-13","2023-08-13","2023-08-14","2023-08-14","2023-08-15","2023-08-15","2023-08-16","2023-08-16","2023-08-17","2023-08-17","2023-08-18","2023-08-18","2023-08-19","2023-08-19","2023-08-20","2023-08-20","2023-08-21","2023-08-21","2023-08-22","2023-08-22","2023-08-23","2023-08-23","2023-08-24","2023-08-24","2023-08-25","2023-08-25","2023-08-26","2023-08-26","2023-08-27","2023-08-27","2023-08-28","2023-08-28","2023-08-29","2023-08-29","2023-08-30","2023-08-30","2023-08-31","2023-08-31","2023-09-01","2023-09-01","2023-09-02","2023-09-02","2023-09-03","2023-09-03","2023-09-04","2023-09-04","2023-09-05","2023-09-05","2023-09-06","2023-09-06","2023-09-07","2023-09-07","2023-09-08","2023-09-08","2023-09-09","2023-09-09","2023-09-10","2023-09-10","2023-09-11","2023-09-11","2023-09-12","2023-09-12","2023-09-13","2023-09-13","2023-09-14","2023-09-14","2023-09-15","2023-09-15","2023-09-16","2023-09-16","2023-09-17","2023-09-17","2023-09-18","2023-09-18","2023-09-19","2023-09-19","2023-09-20","2023-09-20","2023-09-21","2023-09-21","2023-09-22","2023-09-22","2023-09-23","2023-09-23","2023-09-24","2023-09-24","2023-09-25","2023-09-25","2023-09-26","2023-09-26","2023-09-27","2023-09-27","2023-09-28","2023-09-28","2023-09-29","2023-09-29","2023-09-30","2023-09-30","2023-10-01","2023-10-01","2023-10-02","2023-10-02","2023-10-03","2023-10-03","2023-10-04","2023-10-04","2023-10-05","2023-10-05","2023-10-06","2023-10-06","2023-10-07","2023-10-07","2023-10-08","2023-10-08","2023-10-09","2023-10-09","2023-10-10","2023-10-10","2023-10-11","2023-10-11","2023-10-12","2023-10-12","2023-10-13","2023-10-13","2023-10-14","2023-10-14","2023-10-15","2023-10-15","2023-10-16","2023-10-16","2023-10-17","2023-10-17","2023-10-18","2023-10-18","2023-10-19","2023-10-19","2023-10-20","2023-10-20","2023-10-21","2023-10-21","2023-10-22","2023-10-22","2023-10-23","2023-10-23","2023-10-24","2023-10-24","2023-10-25","2023-10-25","2023-10-26","2023-10-26","2023-10-27","2023-10-27","2023-10-28","2023-10-28","2023-10-29","2023-10-29","2023-10-30","2023-10-30","2023-10-31","2023-10-31","2023-11-01","2023-11-01","2023-11-02","2023-11-02","2023-11-03","2023-11-03","2023-11-04","2023-11-04","2023-11-05","2023-11-05","2023-11-06","2023-11-06","2023-11-07","2023-11-07","2023-11-08","2023-11-08","2023-11-09","2023-11-09","2023-11-10","2023-11-10","2023-11-11","2023-11-11","2023-11-12","2023-11-12","2023-11-13","2023-11-13","2023-11-14","2023-11-14","2023-11-15","2023-11-15","2023-11-16","2023-11-16","2023-11-17","2023-11-17","2023-11-18","2023-11-18","2023-11-19","2023-11-19","2023-11-20","2023-11-20","2023-11-21","2023-11-21","2023-11-22","2023-11-22","2023-11-23","2023-11-23","2023-11-24","2023-11-24","2023-11-25","2023-11-25","2023-11-26","2023-11-26","2023-11-27","2023-11-27","2023-11-28","2023-11-28","2023-11-29","2023-11-29","2023-11-30","2023-11-30","2023-12-01","2023-12-01","2023-12-02","2023-12-02","2023-12-03","2023-12-03","2023-12-04","2023-12-04","2023-12-05","2023-12-05","2023-12-06","2023-12-06","2023-12-07","2023-12-07","2023-12-08","2023-12-08","2023-12-09","2023-12-09","2023-12-10","2023-12-10","2023-12-11","2023-12-11","2023-12-12","2023-12-12","2023-12-13","2023-12-13","2023-12-14","2023-12-14","2023-12-15","2023-12-15","2023-12-16","2023-12-16","2023-12-17","2023-12-17","2023-12-18","2023-12-18","2023-12-19","2023-12-19","2023-12-20","2023-12-20","2023-12-21","2023-12-21","2023-12-22","2023-12-22","2023-12-23","2023-12-23","2023-12-24","2023-12-24","2023-12-25","2023-12-25","2023-12-26","2023-12-26","2023-12-27","2023-12-27","2023-12-28","2023-12-28","2023-12-29","2023-12-29","2023-12-30","2023-12-30","2023-12-31","2023-12-31"],"member_casual":["casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member","casual","member"],"n":[1181,2131,934,2850,677,3038,896,4497,792,3932,852,3716,887,2874,969,2768,1050,4854,1300,6005,1444,6344,1125,5183,920,4084,987,3050,1070,3096,638,2592,1123,5626,1109,5328,805,4417,933,4487,998,3302,426,1820,627,4134,958,5240,420,2771,499,3182,410,2515,275,1450,266,1382,289,2384,402,2576,522,3406,617,3857,353,2110,663,2684,841,2872,824,4543,982,5255,1013,5340,506,2784,930,4256,1517,3852,1900,4263,1314,5581,1152,5652,1099,5207,344,2229,526,2625,1188,3053,2023,4089,1240,4515,993,4839,390,2125,943,4669,787,3654,940,2822,1343,3591,915,3676,1247,6162,1817,6822,1223,5425,865,3802,1507,3779,1687,4064,994,4931,1346,5924,1336,5890,1034,4681,794,3428,1762,3498,581,2123,707,3571,1309,5019,1526,5810,1264,4999,1191,4129,587,1895,1027,2772,1260,5144,1678,6548,1252,5366,1245,5061,1368,4883,927,2637,1234,3254,1277,5292,1636,6595,1353,5802,1858,6369,1493,4488,1361,3413,2511,4901,1402,5660,1186,5210,1647,5423,2137,6695,2293,5568,3942,5806,3610,5234,3065,8225,4207,10044,4750,10499,5294,10709,6026,9893,8749,9295,1394,3109,938,4218,2445,8160,2434,7575,3210,8296,3942,7947,2302,4411,1741,3975,1907,6657,1611,6017,2255,7715,3520,9106,3021,7324,2857,4774,1456,3282,795,3861,1906,7259,2424,8220,3965,9788,5479,9823,6147,7354,6778,8064,1594,5750,3625,9626,4609,10855,4975,11074,2560,6126,4067,6447,2432,4452,2988,8526,4208,10575,3443,9332,4574,10518,3963,7976,7024,8597,7740,9035,4601,10069,5686,11644,4124,10135,3927,9445,5331,8993,6907,7762,7383,7531,7106,7549,4921,11006,4721,10989,5769,11372,7337,11231,9941,10500,7669,9133,5120,10497,4530,10842,5163,11365,5420,11082,6916,11137,10588,10916,2537,4207,3982,9449,1655,5664,4997,11052,4628,10259,5331,9370,9156,9621,7041,8428,6178,9937,5145,11507,5764,11863,6019,11651,7359,11016,10432,10397,6726,7483,3768,8980,3922,9750,4595,9834,4095,8922,5962,9552,6893,7311,1601,2083,7535,9505,8520,7909,3470,7926,5550,11184,6604,10735,7691,8889,8098,9792,5138,10934,4087,10809,2599,7441,5574,11923,6396,10263,9163,9722,7700,8765,5180,10901,5492,12454,6012,12626,6344,12113,7437,11325,7783,8702,8454,9395,5321,11023,5389,11992,4918,10887,5807,11715,5359,9034,10273,10293,8402,9645,5242,11195,5844,12660,7173,12625,7258,12305,8977,11606,5028,6113,5577,6952,5336,10542,5279,12154,5496,12174,5776,11684,6861,10701,10846,10824,6958,8430,1699,5231,4703,11052,5878,12417,4740,9957,7277,11286,10154,10619,8431,9162,4751,11048,5258,12575,4568,10279,4595,9574,6279,11069,7761,9572,6899,9215,4625,11231,4991,12515,5019,12303,5528,11988,6494,10089,8840,8827,8814,7955,7408,7701,4635,11224,4187,10290,4781,11468,3909,8059,8766,10270,7714,9267,1236,4133,4720,11721,4518,11754,5038,11719,7147,10959,8819,9015,4416,5901,4067,10371,2286,7345,4978,11923,4464,10939,6046,10734,9079,10323,6674,8665,3853,9637,3497,9385,3617,10699,4492,11427,5771,10560,8617,9925,7194,9003,4634,10774,5171,12325,5656,12379,4368,10664,4172,8226,6370,7928,6690,7064,3855,8677,3666,10262,3404,9721,2834,8244,1946,5432,1925,3958,3890,6234,2446,8406,3475,10572,3374,10516,2661,8522,3891,8826,4920,7054,4336,6532,2965,9056,4277,11734,2454,7993,2840,9117,3350,8264,3256,6105,1630,3668,1776,7206,1052,5336,1556,6680,2348,8489,2873,7893,4342,6967,3421,6236,2798,9282,2356,9167,2030,7962,3519,9376,2461,7072,3480,6000,2870,5703,2428,8605,2678,9605,2790,9675,3093,9818,2462,7282,3147,5739,2255,4660,1221,5342,1163,5116,1423,4811,880,1995,768,2235,1079,2722,392,1656,698,4311,801,4720,1236,6248,1940,7639,749,2898,1702,4647,930,3166,1137,5996,875,4724,1297,6234,1718,7341,2132,6965,2013,4617,1182,3091,952,5116,1020,5711,1075,5865,1498,6313,1792,5940,618,1911,1123,3120,690,4059,788,4285,1130,5073,1203,4830,600,2354,874,2265,844,1902,358,781,735,2365,1017,3230,483,2209,737,2645,900,2486,528,1370],"sdev":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]}}]}
</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Bike_Share</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./bikeShare.html" aria-current="page"> 
<span class="menu-text">Bike Share</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#case-study-bike-sharing-rethought" id="toc-case-study-bike-sharing-rethought" class="nav-link active" data-scroll-target="#case-study-bike-sharing-rethought">Case Study: Bike-Sharing, Rethought</a>
  <ul class="collapse">
  <li><a href="#filtering-data-smartly" id="toc-filtering-data-smartly" class="nav-link" data-scroll-target="#filtering-data-smartly">Filtering Data, Smartly</a></li>
  <li><a href="#visualizations" id="toc-visualizations" class="nav-link" data-scroll-target="#visualizations">Visualizations</a></li>
  </ul></li>
  </ul>
<div class="quarto-code-links"><h2>Code Links</h2><ul><li><a href="repo"><i class="bi bi-link-45deg"></i>Project Repo</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">BikeShare</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Eric Mossotti </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="case-study-bike-sharing-rethought" class="level1 page-columns page-full">
<h1>Case Study: Bike-Sharing, Rethought</h1>
<section id="references" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="references">References:</h4>
<ul>
<li><p><a href="https://bikeshare-research.org/#bssid:chicago">Bike-share research (bikeshare-research.org)</a></p></li>
<li><p><a href="https://en.wikipedia.org/wiki/Divvy">Divvy - Wikipedia</a></p></li>
<li><p><a href="https://en.wikipedia.org/wiki/Cycling_in_Chicago">Cycling in Chicago - Wikipedia</a></p></li>
<li><p><a href="https://divvybikes.com/">Home | Divvy Bikes</a></p></li>
<li><p><a href="https://divvybikes.com/pricing">Divvy Membership &amp; Pass Options | Divvy Bikes</a></p></li>
<li><p><span class="citation" data-cites="datalic">(<a href="#ref-datalic" role="doc-biblioref"><span>“Data License Agreement | Divvy Bikes,”</span> n.d.</a>)</span></p>
<ul>
<li><a href="https://divvybikes.com/data-license-agreement">Data License Agreement | Divvy Bikes</a></li>
</ul></li>
<li><p><span class="citation" data-cites="motivate">(<a href="#ref-motivate" role="doc-biblioref"><span>“MOTIVATE,”</span> n.d.</a>)</span></p>
<ul>
<li><a href="https://motivateco.com/">MOTIVATE (motivateco.com)</a></li>
</ul></li>
<li><p><span class="citation" data-cites="indexof">(<a href="#ref-indexof" role="doc-biblioref"><span>“Index of Bucket <span>"</span>Divvy-Tripdata<span>"</span>,”</span> n.d.</a>)</span></p>
<ul>
<li><a href="https://divvy-tripdata.s3.amazonaws.com/index.html">Index of bucket “divvy-tripdata”</a></li>
</ul></li>
<li><p><span class="citation" data-cites="whyduck">(<a href="#ref-whyduck" role="doc-biblioref"><span>“Why DuckDB,”</span> n.d.</a>)</span></p>
<ul>
<li><a href="https://duckdb.org/why_duckdb">Why DuckDB?</a></li>
</ul></li>
<li><p><span class="citation" data-cites="rforda">(<a href="#ref-rforda" role="doc-biblioref"><span>“R for Data Science (2e) - 22&nbsp; Arrow,”</span> n.d.</a>)</span></p>
<ul>
<li><a href="https://r4ds.hadley.nz/arrow" title="Arrow">R for Data Science: Chapter 22: Arrow</a></li>
</ul></li>
<li><p><span class="citation" data-cites="great-ci">(<a href="#ref-great-ci" role="doc-biblioref"><span>“Great-Circle Distance - Wikipedia,”</span> n.d.</a>)</span></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Great-circle_distance" class="uri">https://en.wikipedia.org/wiki/Great-circle_distance</a></li>
</ul></li>
<li><p><span class="citation" data-cites="average2024">(<a href="#ref-average2024" role="doc-biblioref"><span>“Average Bicycle Speed <span></span> How Fast Do Cyclists Ride and What Affects Their Pace - BikingulTimate.com (UPDATE 👍)”</span> 2024</a>)</span></p>
<ul>
<li><a href="https://bikingultimate.com/average-bicycle-speed-how-fast-do-cyclists-ride-and-what-affects-their-pace/" class="uri">https://bikingultimate.com/average-bicycle-speed-how-fast-do-cyclists-ride-and-what-affects-their-pace/</a></li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>durls <span class="ot">&lt;-</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"https://divvy-tripdata.s3.amazonaws.com/%d-divvy-tripdata.zip"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>            <span class="dv">202301</span><span class="sc">:</span><span class="dv">202312</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Need some directories to store the files. </span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"tempZips"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>tempZipPaths <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"tempZips/%d-divvy-tripdata.zip"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">202301</span><span class="sc">:</span><span class="dv">202312</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># A simple way to download and relocate several files. </span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>curl<span class="sc">::</span><span class="fu">multi_download</span>(durls,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">destfiles =</span> tempZipPaths)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'dir + lists for unz function'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create tempFile directory</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"tempFiles"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create list of tempFile directory paths</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>tempfile_paths <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"tempFiles/%d-divvy-tripdata.csv"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">202301</span><span class="sc">:</span><span class="dv">202312</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># create CSV file relocation directory</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"tripdata"</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># create CSV file relocation paths</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>fileList <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"tripdata/%d-divvy-tripdata.csv"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">202301</span><span class="sc">:</span><span class="dv">202312</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># create CSV list to specify for unzipping</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>fileNames <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%d-divvy-tripdata.csv"</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">202301</span><span class="sc">:</span><span class="dv">202312</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'unzip and relocate function'</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A custom function that makes unzipping, converting and relocating files all at once, simple. </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>unz_relocate <span class="ot">&lt;-</span> <span class="cf">function</span> (<span class="at">x =</span> tempfile_paths,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> tempZipPaths,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">z =</span> fileNames) {</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(x)) {</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        utils<span class="sc">::</span><span class="fu">unzip</span>(y[i],</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                     z[i])</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">file.rename</span>(z[i],</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                    x[i])</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">unz_relocate</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'remove zips folder from working directory'</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># To remove stored files</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">"tempZips"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'create tibble from temp CSV'</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>tripTibble <span class="ot">&lt;-</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">map</span>(tempfile_paths[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>],</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                         arrow<span class="sc">::</span>read_csv_arrow) <span class="sc">|&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">list_rbind</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'count raw obs, then drop NAs'</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Need to save this count for later before I drop the incomplete obs</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>original_nobs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(tripTibble)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>tripTibble <span class="ot">&lt;-</span> tripTibble <span class="sc">|&gt;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'new calculated column for trip time'</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># To make use of supplied trip interval data</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>tripTibble <span class="sc">|&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">"trip_time"</span> <span class="ot">=</span> lubridate<span class="sc">::</span><span class="fu">time_length</span>(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        lubridate<span class="sc">::</span><span class="fu">interval</span>(started_at,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                            ended_at),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">unit =</span> <span class="st">"minute"</span>), </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">.keep =</span> <span class="st">"all"</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">write_dataset</span>(<span class="st">"tempFiles"</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">existing_data_behavior =</span> <span class="st">"delete"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'removing large tibble from memory'</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tripTibble)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'create and view list of files'</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>fileList <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"tempFiles"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">full.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'create/write a parquet file dataset'</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>tripset <span class="ot">&lt;-</span> arrow<span class="sc">::</span><span class="fu">open_dataset</span>(<span class="at">sources =</span> fileList[<span class="dv">1</span>],</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">format =</span> <span class="st">"parquet"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>tripset <span class="sc">|&gt;</span> arrow<span class="sc">::</span><span class="fu">write_dataset</span>(<span class="at">path =</span> <span class="st">"tripdata"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">format =</span> <span class="st">"parquet"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell column-page">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tripset <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    polars<span class="sc">::</span><span class="fu">as_polars_df</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (4_331_707, 14)
┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
│ ride_id   ┆ rideable_ ┆ started_a ┆ ended_at  ┆ … ┆ end_lat   ┆ end_lng   ┆ member_ca ┆ trip_tim │
│ ---       ┆ type      ┆ t         ┆ ---       ┆   ┆ ---       ┆ ---       ┆ sual      ┆ e        │
│ str       ┆ ---       ┆ ---       ┆ datetime[ ┆   ┆ f64       ┆ f64       ┆ ---       ┆ ---      │
│           ┆ str       ┆ datetime[ ┆ ms]       ┆   ┆           ┆           ┆ str       ┆ f64      │
│           ┆           ┆ ms]       ┆           ┆   ┆           ┆           ┆           ┆          │
╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
│ F96D5A74A ┆ electric_ ┆ 2023-01-2 ┆ 2023-01-2 ┆ … ┆ 41.93     ┆ -87.64    ┆ member    ┆ 10.85    │
│ 3E41399   ┆ bike      ┆ 1         ┆ 1         ┆   ┆           ┆           ┆           ┆          │
│           ┆           ┆ 14:05:42  ┆ 14:16:33  ┆   ┆           ┆           ┆           ┆          │
│ 13CB7EB69 ┆ classic_b ┆ 2023-01-1 ┆ 2023-01-1 ┆ … ┆ 41.809835 ┆ -87.59938 ┆ member    ┆ 8.483333 │
│ 8CEDB88   ┆ ike       ┆ 0         ┆ 0         ┆   ┆           ┆ 3         ┆           ┆          │
│           ┆           ┆ 09:37:36  ┆ 09:46:05  ┆   ┆           ┆           ┆           ┆          │
│ BD88A2E67 ┆ electric_ ┆ 2023-01-0 ┆ 2023-01-0 ┆ … ┆ 42.039742 ┆ -87.69941 ┆ casual    ┆ 13.23333 │
│ 0661CE5   ┆ bike      ┆ 2         ┆ 2         ┆   ┆           ┆ 3         ┆           ┆ 3        │
│           ┆           ┆ 01:51:57  ┆ 02:05:11  ┆   ┆           ┆           ┆           ┆          │
│ C90792D03 ┆ classic_b ┆ 2023-01-2 ┆ 2023-01-2 ┆ … ┆ 41.809835 ┆ -87.59938 ┆ member    ┆ 8.766667 │
│ 4FED968   ┆ ike       ┆ 2         ┆ 2         ┆   ┆           ┆ 3         ┆           ┆          │
│           ┆           ┆ 04:52:58  ┆ 05:01:44  ┆   ┆           ┆           ┆           ┆          │
│ 339701752 ┆ classic_b ┆ 2023-01-1 ┆ 2023-01-1 ┆ … ┆ 41.809835 ┆ -87.59938 ┆ member    ┆ 15.31666 │
│ 9188E8A   ┆ ike       ┆ 2         ┆ 2         ┆   ┆           ┆ 3         ┆           ┆ 7        │
│           ┆           ┆ 07:58:01  ┆ 08:13:20  ┆   ┆           ┆           ┆           ┆          │
│ …         ┆ …         ┆ …         ┆ …         ┆ … ┆ …         ┆ …         ┆ …         ┆ …        │
│ F74DF9549 ┆ electric_ ┆ 2023-12-0 ┆ 2023-12-0 ┆ … ┆ 41.87464  ┆ -87.65703 ┆ casual    ┆ 2.216667 │
│ B504A6B   ┆ bike      ┆ 7         ┆ 7         ┆   ┆           ┆           ┆           ┆          │
│           ┆           ┆ 07:15:24  ┆ 07:17:37  ┆   ┆           ┆           ┆           ┆          │
│ BCDA66E76 ┆ classic_b ┆ 2023-12-0 ┆ 2023-12-0 ┆ … ┆ 41.87464  ┆ -87.65703 ┆ casual    ┆ 3.583333 │
│ 1CC1029   ┆ ike       ┆ 8         ┆ 8         ┆   ┆           ┆           ┆           ┆          │
│           ┆           ┆ 12:42:21  ┆ 12:45:56  ┆   ┆           ┆           ┆           ┆          │
│ D2CF330F9 ┆ classic_b ┆ 2023-12-0 ┆ 2023-12-0 ┆ … ┆ 41.87464  ┆ -87.65703 ┆ member    ┆ 3.833333 │
│ C266683   ┆ ike       ┆ 5         ┆ 5         ┆   ┆           ┆           ┆           ┆          │
│           ┆           ┆ 08:09:11  ┆ 08:13:01  ┆   ┆           ┆           ┆           ┆          │
│ 3829A0D1E ┆ electric_ ┆ 2023-12-0 ┆ 2023-12-0 ┆ … ┆ 41.885492 ┆ -87.65228 ┆ casual    ┆ 17.63333 │
│ 00EE970   ┆ bike      ┆ 2         ┆ 2         ┆   ┆           ┆ 9         ┆           ┆ 3        │
│           ┆           ┆ 15:36:07  ┆ 15:53:45  ┆   ┆           ┆           ┆           ┆          │
│ A373F5B44 ┆ classic_b ┆ 2023-12-1 ┆ 2023-12-1 ┆ … ┆ 41.87464  ┆ -87.65703 ┆ member    ┆ 3.633333 │
│ 7AEA508   ┆ ike       ┆ 1         ┆ 1         ┆   ┆           ┆           ┆           ┆          │
│           ┆           ┆ 07:07:46  ┆ 07:11:24  ┆   ┆           ┆           ┆           ┆          │
└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'delete CSV directory'</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># all files and folders</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">"tempFiles"</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'open parquet file dataset'</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>tripset <span class="ot">&lt;-</span> arrow<span class="sc">::</span><span class="fu">open_dataset</span>(<span class="at">sources =</span> <span class="st">"tripdata"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">format =</span> <span class="st">"parquet"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'create/view list of parquets'</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># To verify the location of the extracted data.</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>fileList <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"tripdata"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">full.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'create dupe-table, count n distinct'</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a separate table used to analyze the observations returned as not distinct (n &gt; 1). This adds an extra column labeled "n".</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>dupeTable <span class="ot">&lt;-</span> tripset <span class="sc">|&gt;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">to_duckdb</span>() <span class="sc">|&gt;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(started_at<span class="sc">:</span>end_station_name) <span class="sc">|&gt;</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Counts of unique rows added for column 'n'</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">add_count</span>(started_at,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                     ended_at,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>                     start_station_name,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>                     end_station_name) <span class="sc">|&gt;</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Only observations that have been duplicated 1 or more </span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># times are shown</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We want to see all rows, not just one row for each obs</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(started_at) <span class="sc">|&gt;</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>()</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> dupeTable <span class="sc">|&gt;</span> </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(n) <span class="sc">|&gt;</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.integer</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We started with 5,719,877 observations (obs) for dates spanning January to December, 2023, then removed 1,388,170 incomplete obs.</p>
<p>Of the other columns, it seems that the start_time, end_time, start_station, and end_station could show if there are possibly hidden duplicated observations. Those 4 variables combined results in the most granular view of any one observation. Meaning, that data would naturally only have duplicates in error.</p>
<p>I assumed that having the same times/dates and stations for two different ride IDs was a mistake. Although, I do not know how that error would happen. I could have assumed one person could check out multiple bikes at once. In that instance, each bike could be assigned a unique ride_id. That, however, has only happened 18 times over a year. Since it’s only one copy every time, that also raises a red flag. I did not notice any other correlations with station_id/name, member_casual, or ride_type for those particular duplicated data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'output to distinct duplicates and total obs'</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">" Distinct copy count of dupes: "</span>, n,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Total observations that have and are duplicates: "</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">length</span>(dupeTable[[<span class="dv">1</span>]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Distinct copy count of dupes:  2 

 Total observations that have and are duplicates:  36</code></pre>
</div>
</div>
<p>By applying distinct() on dupeTable, we see the only distinct value is 2. We can safely conclude that, of the duplicates, each has a minimum and maximum of 1 extra copy.</p>
<p>Number of rows in the dupeTable is 36. Because each duplicated observation has one duplicate (n = 2), expected removed nobs is 18. The issue is that we need to get rid of not all 36 rows, but just the 1 extra duplicate observation from each, resulting in the expected 18.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'create un-duped table, count rows'</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The issue is, we need to get rid of not all of these rows, but just the extra duplicate observations. </span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># If there were 2 rows of duplicates, we would want to end up with 1 row after removing the extras.</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>undupedTable <span class="ot">&lt;-</span> dupeTable <span class="sc">|&gt;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">to_duckdb</span>() <span class="sc">|&gt;</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(started_at,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>                     start_station_name,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                     ended_at,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>                     end_station_name,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>()</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> undupedTable <span class="sc">|&gt;</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(started_at) <span class="sc">|&gt;</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>() <span class="sc">|&gt;</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>() <span class="sc">|&gt;</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.integer</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'output distinct obs, n'</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Count of distinct observations: "</span>, n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Count of distinct observations:  18</code></pre>
</div>
</div>
<p>The count of observed distinct values for the un-duplicated table was indeed 18. So now, it is time to run a count of how rows/observations are in the dataset. There is a difference, though, concerning the correct amount.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'incorrect/correct distinct observations'</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Run an incorrect count on how many rows or observations there are in the dataset.</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>incorrectDistinct <span class="ot">&lt;-</span> tripset <span class="sc">|&gt;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">to_duckdb</span>() <span class="sc">|&gt;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(dplyr<span class="sc">::</span><span class="fu">pick</span>(<span class="st">"ride_id"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>(<span class="at">name =</span> <span class="st">"Incorrect Distinct Observations"</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.integer</span>()</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># For the correct count of obs</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>correctDistinct <span class="ot">&lt;-</span> tripset <span class="sc">|&gt;</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">to_duckdb</span>() <span class="sc">|&gt;</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">pick</span>(</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"started_at"</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">"start_station_name"</span>,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">"ended_at"</span>,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">"end_station_name"</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>() <span class="sc">|&gt;</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.integer</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell column-body-outset fig-cap-location-margin">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23" data-cap-location="margin"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To visualize a summary of what we just determined regarding obs</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Original Obs"</span> <span class="ot">=</span> original_nobs,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Uncorrected Complete Obs"</span> <span class="ot">=</span> incorrectDistinct,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Corrected Complete Obs"</span> <span class="ot">=</span> correctDistinct,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Removed Obs"</span> <span class="ot">=</span> (incorrectDistinct <span class="sc">-</span> correctDistinct)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    polars<span class="sc">::</span><span class="fu">as_polars_df</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre data-cap-location="margin"><code>shape: (1, 4)
┌──────────────┬──────────────────────────┬────────────────────────┬─────────────┐
│ Original Obs ┆ Uncorrected Complete Obs ┆ Corrected Complete Obs ┆ Removed Obs │
│ ---          ┆ ---                      ┆ ---                    ┆ ---         │
│ i32          ┆ i32                      ┆ i32                    ┆ i32         │
╞══════════════╪══════════════════════════╪════════════════════════╪═════════════╡
│ 5719877      ┆ 4331707                  ┆ 4331689                ┆ 18          │
└──────────────┴──────────────────────────┴────────────────────────┴─────────────┘</code></pre>
</div>
</div>
<p>The incorrect number of observations (nobs) was 4,331,707. The correct nobs after removing duplicated obs was 4,331,689. In short, 18 additional obs were removed.</p>
<div class="cell column-body-outset">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the data to a file to ensure we have a copy free from incomplete and duplicated obs.</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>tripset <span class="sc">|&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(ride_id<span class="sc">:</span>trip_time) <span class="sc">|&gt;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">to_duckdb</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(started_at, </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                    start_station_name, </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                    ended_at,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>                    end_station_name, </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(started_at) <span class="sc">|&gt;</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">write_dataset</span>(</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">path =</span> <span class="st">"tripdata"</span>,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">format =</span> <span class="st">"parquet"</span>,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">existing_data_behavior =</span> <span class="st">"overwrite"</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Noting that it was useful for me to retain certain rows at first to determine if there were duplicates.</p>
<div class="cell column-page">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>tripset <span class="ot">&lt;-</span> arrow<span class="sc">::</span><span class="fu">open_dataset</span>(<span class="st">"tripdata"</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">format =</span> <span class="st">"parquet"</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>dbconn <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(duckdb<span class="sc">::</span><span class="fu">duckdb</span>())</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For querying the arrow dataset with the benefits of an OLAP database. </span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>duckdb<span class="sc">::</span><span class="fu">duckdb_register_arrow</span>(dbconn,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"unfltrd_tripData"</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                              tripset)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>           <span class="st">"unfltrd_tripData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   table&lt;unfltrd_tripData&gt; [?? x 14]
# Database: DuckDB v0.10.0 [ecmos@Windows 10 x64:R 4.3.3/:memory:]
   ride_id          rideable_type started_at          ended_at           
   &lt;chr&gt;            &lt;chr&gt;         &lt;dttm&gt;              &lt;dttm&gt;             
 1 D8EEE72183269F07 classic_bike  2023-01-01 00:02:06 2023-01-01 00:29:46
 2 E5AD797A579842F8 electric_bike 2023-01-01 00:03:26 2023-01-01 00:07:23
 3 8FBD2AD70B0F6A6F classic_bike  2023-01-01 00:04:07 2023-01-01 00:13:56
 4 B05BD052B9EBB767 electric_bike 2023-01-01 00:04:27 2023-01-01 00:16:52
 5 F9EA7B9E6C243CFC classic_bike  2023-01-01 00:04:54 2023-01-01 00:31:52
 6 27C2A67184C49D01 electric_bike 2023-01-01 00:05:43 2023-01-01 00:21:37
 7 776F6B226016E50A classic_bike  2023-01-01 00:06:03 2023-01-01 00:29:39
 8 31FFA227B5C5FF4F electric_bike 2023-01-01 00:07:45 2023-01-01 00:13:21
 9 544EFA0F99CA9099 electric_bike 2023-01-01 00:09:33 2023-01-01 00:14:21
10 4BA829307ABF42BA classic_bike  2023-01-01 00:09:53 2023-01-01 00:25:01
# ℹ more rows
# ℹ 10 more variables: start_station_name &lt;chr&gt;, start_station_id &lt;chr&gt;,
#   end_station_name &lt;chr&gt;, end_station_id &lt;chr&gt;, start_lat &lt;dbl&gt;,
#   start_lng &lt;dbl&gt;, end_lat &lt;dbl&gt;, end_lng &lt;dbl&gt;, member_casual &lt;chr&gt;,
#   trip_time &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="filtering-data-smartly" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="filtering-data-smartly">Filtering Data, Smartly</h2>
<p>To ensure the conclusions are accurate, outliers should be filtered. Negative and very low trip times might skew trends. The underlying reason for very low trip times is somewhat of an unknown. Perhaps people often change their minds?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'add/filter distances and speed'</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># imposing sensible limits on the data we wish to include moving forward</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># might as well calculate distance traveled while at it</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">"unfltrd_tripData"</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(trip_time <span class="sc">&gt;</span> <span class="dv">1</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                  trip_time <span class="sc">&lt;</span> <span class="dv">480</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                  rideable_type <span class="sc">!=</span> <span class="st">"docked_bike"</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">miles =</span> geosphere<span class="sc">::</span><span class="fu">distGeo</span>(</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">p1 =</span> <span class="fu">cbind</span>(start_lng, start_lat),</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">p2 =</span> <span class="fu">cbind</span>(end_lng, end_lat)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">/</span> <span class="dv">1000</span> <span class="sc">*</span> <span class="fl">0.62137119</span>,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">mph =</span> (miles <span class="sc">/</span> (trip_time <span class="sc">/</span> <span class="dv">60</span>))</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># It's somewhat nonsensical to rent a bike for distances easily walked. </span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Also, there could be randomly generated data.</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(miles <span class="sc">&gt;</span> <span class="fl">0.1</span>,</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># Seems that pro cyclists average around 20 mph, </span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># so I set that as the ceiling.</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>                  mph <span class="sc">&lt;</span> <span class="dv">21</span>,</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># To account for time spent idling, stoplights and traffic.</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>                  mph <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    duckdb<span class="sc">::</span><span class="fu">dbWriteTable</span>(<span class="at">conn =</span> dbconn,</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">name =</span> <span class="st">"fltrd_tripData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Writing the Filtered Parquet File</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'write fltrdData parquet'</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"fltrdData"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">"fltrd_tripData"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">to_arrow</span>() <span class="sc">|&gt;</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">write_parquet</span>(<span class="at">sink =</span> <span class="st">"fltrdData/fltrd.parquet"</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we have a filtered data file. </span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">'tripdata'</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>duckdb<span class="sc">::</span><span class="fu">dbDisconnect</span>(dbconn, <span class="at">shutdown =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>tripset <span class="ot">&lt;-</span> arrow<span class="sc">::</span><span class="fu">open_dataset</span>(<span class="st">"fltrdData"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">format =</span> <span class="st">"parquet"</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>dbconn <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(duckdb<span class="sc">::</span><span class="fu">duckdb</span>())</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># For querying the arrow dataset with the benefits of an OLAP database. </span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>duckdb<span class="sc">::</span><span class="fu">duckdb_register_arrow</span>(dbconn,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"fltrd_data"</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>                              tripset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'rider count by hour table'</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>hours_of_Riders <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"fltrd_data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(started_at) <span class="sc">|&gt;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">"hour"</span> <span class="ot">=</span> lubridate<span class="sc">::</span><span class="fu">hour</span>(started_at)) <span class="sc">|&gt;</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(hour) <span class="sc">|&gt;</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="st">"riding"</span> <span class="ot">=</span> dplyr<span class="sc">::</span><span class="fu">count</span>(started_at)) <span class="sc">|&gt;</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(hour) <span class="sc">|&gt;</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">"hour"</span> <span class="ot">=</span> hms<span class="sc">::</span><span class="fu">hms</span>(<span class="at">hours =</span> hour),</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"hour"</span> <span class="ot">=</span> <span class="fu">format</span>(<span class="fu">strptime</span>(hour, <span class="at">format =</span> <span class="st">"%H"</span>), <span class="st">"%r"</span>),</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"index"</span> <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="page-columns page-full">
<div class="cell fig-cap-location-bottom page-columns page-full" title="Time of Day and Volume of Cyclers">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32" data-cap-location="bottom"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> hours_of_Riders,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="fu">reorder</span>(hour, .data<span class="sc">$</span>index),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> riding,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill =</span> riding</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                )) <span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">coord_radial</span>(<span class="at">start =</span> <span class="dv">2</span> <span class="sc">*</span> pi,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">inner.radius =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">'Spectral'</span>,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Average Riders by the Hour of Day"</span>,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"(Jan-Dec 2023)"</span>,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Data from cyclistic database."</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">tag =</span> <span class="st">"Figure 1.c"</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>,<span class="at">lineheight =</span> <span class="dv">4</span>),</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"white"</span>),</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> ggplot2<span class="sc">::</span><span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"black"</span>),</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> ggplot2<span class="sc">::</span><span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> ggplot2<span class="sc">::</span><span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey10"</span>),</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> ggplot2<span class="sc">::</span><span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"black"</span>),</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">color =</span> <span class="st">"grey90"</span>),</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> ggplot2<span class="sc">::</span><span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"black"</span>),</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.ticks =</span> ggplot2<span class="sc">::</span><span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">linewidth =</span> .<span class="dv">5</span>),</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">'grey80'</span>,</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">"center"</span>,</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">"vertical"</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="bikeShare_files/figure-html/radial-column plot-1.png" class="img-fluid figure-img column-page" width="1440"></p>
<figcaption>The time of day people tend to be riding.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="visualizations" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="visualizations">Visualizations</h2>
<p>for quick reference with using Tsibble syntax</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'grouped tibb'</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>grouped_byDay <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"fltrd_data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(started_at,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>                  member_casual) <span class="sc">|&gt;</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">started_at =</span> <span class="fu">as.Date</span>(started_at)) <span class="sc">|&gt;</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(started_at,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>                    member_casual) <span class="sc">|&gt;</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sdev =</span> stats<span class="sc">::</span><span class="fu">sd</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'to grouped tsibb'</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tsibble, time-series table/tibble seems to make time series plots more straightforward</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>grouped_tsi <span class="ot">&lt;-</span> grouped_byDay <span class="sc">|&gt;</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    tsibble<span class="sc">::</span><span class="fu">as_tsibble</span>(<span class="at">key =</span> <span class="fu">c</span>(member_casual,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                                n),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">index =</span> started_at) <span class="sc">|&gt;</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(started_at)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: "map query setup"</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># chicago starting coordinates for leaflet, setView</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>chicago <span class="ot">&lt;-</span> maps<span class="sc">::</span>us.cities <span class="sc">|&gt;</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">"name"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"long"</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"lat"</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">"Chicago IL"</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># full dataset coordinates, might need to sample</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>coordQry <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"fltrd_data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(start_lng,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>                  start_lat) <span class="sc">|&gt;</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">add_count</span>(start_lng,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>                     start_lat) <span class="sc">|&gt;</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>() <span class="sc">|&gt;</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>()</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>coordQry_small <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"fltrd_data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(start_lng,</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>                  start_lat) <span class="sc">|&gt;</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">add_count</span>(start_lng,</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>                     start_lat) <span class="sc">|&gt;</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>() <span class="sc">|&gt;</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: "mapview"</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>coordQry_small <span class="sc">|&gt;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">|&gt;</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    mapview<span class="sc">::</span><span class="fu">mapview</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-b4f054e9644e9f90bae5" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b4f054e9644e9f90bae5">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["point",440]},{"method":"addCircleMarkers","args":[[41.892278,41.911722,41.902973,41.88917683258,41.880958,41.90096039,41.926277,41.78509714636,41.791478,41.912133,41.903222,41.88338,41.94023191810859,41.93758231600629,41.867888,41.918306,41.79430062054,41.915689,41.9256018819,41.8810317,41.894722,41.89661720040753,41.891466,41.929546,41.88275196568561,41.893992,41.888716036,41.86722595682,41.931248,41.87222873224032,41.949074,41.94947274088333,41.8839840647265,41.889906,41.890762,41.92416102906763,41.932588,41.87831661183068,41.89259211970973,41.898969,41.921822,41.867227,41.89380805624359,41.945529,41.932418,41.879255,41.943739,41.909668,41.929143,41.954245],[-87.612043,-87.62680400000001,-87.63128,-87.6385057718,-87.616743,-87.62377664,-87.63083399999999,-87.6010727606,-87.599861,-87.63465600000001,-87.63432400000001,-87.64117,-87.65294373035431,-87.64409780502319,-87.623041,-87.63628199999999,-87.60144977340001,-87.63460000000001,-87.6537080423,-87.62408431999999,-87.634362,-87.62857854366302,-87.626761,-87.643118,-87.64119029045105,-87.629318,-87.64444785329999,-87.61535539019999,-87.644336,-87.66136385500431,-87.648636,-87.64645278453827,-87.6246839761734,-87.634266,-87.631697,-87.64638036489487,-87.636427,-87.64098107814789,-87.61728912591934,-87.629912,-87.64413999999999,-87.625961,-87.64169722795485,-87.646439,-87.652705,-87.639904,-87.66401999999999,-87.648128,-87.64907700000001,-87.65440599999999],6,null,"sf::st_as_sf(coordQry_small, coords = c(1:2), ....",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"point","stroke":true,"color":"#333333","weight":1,"opacity":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9],"fill":true,"fillColor":["#DAE12C","#009497","#009497","#008498","#007F97","#007F97","#007F97","#007996","#007996","#006E94","#006290","#005C8D","#155087","#155087","#155087","#254A83","#254A83","#254A83","#2F4480","#2F4480","#363D7C","#363D7C","#3C3777","#3C3777","#3C3777","#3C3777","#403073","#403073","#44296E","#44296E","#44296E","#44296E","#44296E","#44296E","#44296E","#44296E","#462169","#462169","#462169","#462169","#462169","#462169","#462169","#481964","#481964","#481964","#481964","#481964","#481964","#481964"],"fillOpacity":[0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6]},null,null,["<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>1&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>32206&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>2&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>20861&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>3&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>20650&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>4&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>19388&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>5&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>18991&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>6&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>18742&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>7&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>18628&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>8&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>18563&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>9&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>18299&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>10&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>17572&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>11&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>16589&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>12&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>15769&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>13&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>15124&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>14&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>15036&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>15&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>14714&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>16&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>14627&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>17&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>14550&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>18&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>14433&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>19&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>13949&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>20&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>13775&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>21&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>13706&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>22&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>13511&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>23&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>13146&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>24&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>12937&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>25&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>12893&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>26&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>12858&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>27&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>12694&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>28&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>12402&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>29&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>12254&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>30&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>11984&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>31&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>11976&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>32&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>11961&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>33&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>11932&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>34&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>11888&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>35&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>11870&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>36&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>11798&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>37&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>11736&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>38&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>11620&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>39&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>11592&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>40&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>11546&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>41&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>11528&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>42&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>11360&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>43&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>11343&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>44&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>11285&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>45&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>11121&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>46&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>11113&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>47&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>10936&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>48&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>10909&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>49&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>10876&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>50&emsp;<\/td><\/tr><tr><td>1<\/td><th>n&emsp;<\/th><td>10842&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>"],{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},["32206","20861","20650","19388","18991","18742","18628","18563","18299","17572","16589","15769","15124","15036","14714","14627","14550","14433","13949","13775","13706","13511","13146","12937","12893","12858","12694","12402","12254","11984","11976","11961","11932","11888","11870","11798","11736","11620","11592","11546","11528","11360","11343","11285","11121","11113","10936","10909","10876","10842"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-87.66401999999999,41.78509714636,-87.599861,41.954245,true,"sf::st_as_sf(coordQry_small, coords = c(1:2), ....","Zoom to sf::st_as_sf(coordQry_small, coords = c(1:2), ....","<strong> sf::st_as_sf(coordQry_small, coords = c(1:2), .... <\/strong>","bottomright"]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],"sf::st_as_sf(coordQry_small, coords = c(1:2), ....",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addLegend","args":[{"colors":["#4B0055 , #2A4782 19.4626474442988%, #008A98 42.8665043999251%, #00BE7E 66.2703613555514%, #C0DE35 89.6742183111777%, #FDE333 "],"labels":["15,000","20,000","25,000","30,000"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"numeric","title":"sf::st_as_sf(coordQry_small, coords = c(1:2), ....","extra":{"p_1":0.1946264744429882,"p_n":0.8967421831117768},"layerId":null,"className":"info legend","group":"sf::st_as_sf(coordQry_small, coords = c(1:2), ...."}]}],"limits":{"lat":[41.78509714636,41.954245],"lng":[-87.66401999999999,-87.599861]},"fitBounds":[41.78509714636,-87.66401999999999,41.954245,-87.599861,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ojs_define</span>(<span class="at">js_tsi =</span> grouped_tsi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38" data-startfrom="724" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 723;"><span id="cb38-724"><a href="#cb38-724" aria-hidden="true" tabindex="-1"></a>jsData <span class="op">=</span> <span class="fu">transpose</span>(js_tsi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="column-page">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39" data-startfrom="729" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 728;"><span id="cb39-729"><a href="#cb39-729" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb39-730"><a href="#cb39-730" aria-hidden="true" tabindex="-1"></a>    <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb39-731"><a href="#cb39-731" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {<span class="dt">legend</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb39-732"><a href="#cb39-732" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb39-733"><a href="#cb39-733" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">dot</span>(jsData<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">'started_at'</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">'n'</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">'member_casual'</span>})</span>
<span id="cb39-734"><a href="#cb39-734" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb39-735"><a href="#cb39-735" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40" data-startfrom="739" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 738;"><span id="cb40-739"><a href="#cb40-739" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">lineY</span>(jsData<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"started_at"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"n"</span>})<span class="op">.</span><span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41" data-startfrom="743" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 742;"><span id="cb41-743"><a href="#cb41-743" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">table</span>(jsData<span class="op">,</span> {</span>
<span id="cb41-744"><a href="#cb41-744" aria-hidden="true" tabindex="-1"></a><span class="dt">rows</span><span class="op">:</span> <span class="dv">20</span></span>
<span id="cb41-745"><a href="#cb41-745" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'grouped stats tibb'</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Need a useful data frame for basic aggregations</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>groupedStats_byDay <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"fltrd_data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(started_at,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>                  member_casual,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>                  rideable_type,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>                  trip_time,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                  miles,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>                  mph) <span class="sc">|&gt;</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">started_at =</span> <span class="fu">as.Date</span>(started_at)) <span class="sc">|&gt;</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(started_at,</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>                    member_casual,</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>                    rideable_type) <span class="sc">|&gt;</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trip_time_Mean =</span> <span class="fu">mean</span>(trip_time),</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trip_time_stDev =</span> stats<span class="sc">::</span><span class="fu">sd</span>(trip_time),</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">miles_Mean =</span> <span class="fu">mean</span>(miles),</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">miles_stDev =</span> stats<span class="sc">::</span><span class="fu">sd</span>(miles),</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">mph_Mean =</span> <span class="fu">mean</span>(miles),</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">mph_stDev =</span> stats<span class="sc">::</span><span class="fu">sd</span>(mph))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'grouped stats tsibb'</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Would prefer to work with a tsibble for time-series data</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>groupedStats_tsib <span class="ot">&lt;-</span> groupedStats_byDay <span class="sc">|&gt;</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    tsibble<span class="sc">::</span><span class="fu">as_tsibble</span>(<span class="at">key =</span> <span class="fu">c</span>(member_casual<span class="sc">:</span>mph_stDev),</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">index =</span> started_at) <span class="sc">|&gt;</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(started_at)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A solution to help visualize these mutli-dimensional relationships of membership and bike type to time.</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>groupedStats_tsib <span class="sc">|&gt;</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> started_at,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> trip_time_Mean,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">color =</span> trip_time_Mean)) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_count</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>member_casual<span class="sc">+</span>rideable_type) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_x_date</span>(<span class="at">date_minor_breaks =</span> <span class="st">"days"</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">date_labels =</span> <span class="st">"%b"</span>,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">breaks =</span> <span class="st">"months"</span>) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">axis.text.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">panel.background =</span> ggplot2<span class="sc">::</span><span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'grey20'</span>),</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">panel.grid.major.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_line</span>(</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">linetype =</span> <span class="st">'dashed'</span>,</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="st">'grey30'</span>),</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">panel.grid.major.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_line</span>(</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">linetype =</span> <span class="st">'dotted'</span>,</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="st">'grey30'</span>),</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">panel.grid.minor =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>                   <span class="at">strip.background.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_rect</span>(</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> <span class="st">'yellowgreen'</span>)) <span class="sc">+</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">'Spectral'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="bikeShare_files/figure-html/Facet-Wrap Plot-1.png" class="img-fluid figure-img column-page" width="1344"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: "dygraph"</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>sumDF <span class="ot">&lt;-</span> groupedStats_byDay <span class="sc">|&gt;</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(started_at,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                  n) <span class="sc">|&gt;</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(started_at,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>                    member_casual) <span class="sc">|&gt;</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="st">"count"</span> <span class="ot">=</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> member_casual,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">values_from =</span> count)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>dygraphs<span class="sc">::</span><span class="fu">dygraph</span>(sumDF, <span class="at">main =</span> <span class="st">"ever"</span>,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab =</span> <span class="st">"what"</span>) <span class="sc">|&gt;</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    dygraphs<span class="sc">::</span><span class="fu">dyGroup</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">"member"</span>, <span class="st">"casual"</span>),</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="dygraphs html-widget html-fill-item" id="htmlwidget-182f573c9a2951a53b13" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-182f573c9a2951a53b13">{"x":{"attrs":{"title":"ever","ylabel":"what","labels":["day","member","casual"],"legend":"auto","retainDateWindow":false,"axes":{"x":{"pixelsPerLabel":60}},"colors":["green","red"],"series":{"member":{"axis":"y","group":"membercasual"},"casual":{"axis":"y","group":"membercasual"}}},"scale":"daily","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2023-01-01T00:00:00.000Z","2023-01-02T00:00:00.000Z","2023-01-03T00:00:00.000Z","2023-01-04T00:00:00.000Z","2023-01-05T00:00:00.000Z","2023-01-06T00:00:00.000Z","2023-01-07T00:00:00.000Z","2023-01-08T00:00:00.000Z","2023-01-09T00:00:00.000Z","2023-01-10T00:00:00.000Z","2023-01-11T00:00:00.000Z","2023-01-12T00:00:00.000Z","2023-01-13T00:00:00.000Z","2023-01-14T00:00:00.000Z","2023-01-15T00:00:00.000Z","2023-01-16T00:00:00.000Z","2023-01-17T00:00:00.000Z","2023-01-18T00:00:00.000Z","2023-01-19T00:00:00.000Z","2023-01-20T00:00:00.000Z","2023-01-21T00:00:00.000Z","2023-01-22T00:00:00.000Z","2023-01-23T00:00:00.000Z","2023-01-24T00:00:00.000Z","2023-01-25T00:00:00.000Z","2023-01-26T00:00:00.000Z","2023-01-27T00:00:00.000Z","2023-01-28T00:00:00.000Z","2023-01-29T00:00:00.000Z","2023-01-30T00:00:00.000Z","2023-01-31T00:00:00.000Z","2023-02-01T00:00:00.000Z","2023-02-02T00:00:00.000Z","2023-02-03T00:00:00.000Z","2023-02-04T00:00:00.000Z","2023-02-05T00:00:00.000Z","2023-02-06T00:00:00.000Z","2023-02-07T00:00:00.000Z","2023-02-08T00:00:00.000Z","2023-02-09T00:00:00.000Z","2023-02-10T00:00:00.000Z","2023-02-11T00:00:00.000Z","2023-02-12T00:00:00.000Z","2023-02-13T00:00:00.000Z","2023-02-14T00:00:00.000Z","2023-02-15T00:00:00.000Z","2023-02-16T00:00:00.000Z","2023-02-17T00:00:00.000Z","2023-02-18T00:00:00.000Z","2023-02-19T00:00:00.000Z","2023-02-20T00:00:00.000Z","2023-02-21T00:00:00.000Z","2023-02-22T00:00:00.000Z","2023-02-23T00:00:00.000Z","2023-02-24T00:00:00.000Z","2023-02-25T00:00:00.000Z","2023-02-26T00:00:00.000Z","2023-02-27T00:00:00.000Z","2023-02-28T00:00:00.000Z","2023-03-01T00:00:00.000Z","2023-03-02T00:00:00.000Z","2023-03-03T00:00:00.000Z","2023-03-04T00:00:00.000Z","2023-03-05T00:00:00.000Z","2023-03-06T00:00:00.000Z","2023-03-07T00:00:00.000Z","2023-03-08T00:00:00.000Z","2023-03-09T00:00:00.000Z","2023-03-10T00:00:00.000Z","2023-03-11T00:00:00.000Z","2023-03-12T00:00:00.000Z","2023-03-13T00:00:00.000Z","2023-03-14T00:00:00.000Z","2023-03-15T00:00:00.000Z","2023-03-16T00:00:00.000Z","2023-03-17T00:00:00.000Z","2023-03-18T00:00:00.000Z","2023-03-19T00:00:00.000Z","2023-03-20T00:00:00.000Z","2023-03-21T00:00:00.000Z","2023-03-22T00:00:00.000Z","2023-03-23T00:00:00.000Z","2023-03-24T00:00:00.000Z","2023-03-25T00:00:00.000Z","2023-03-26T00:00:00.000Z","2023-03-27T00:00:00.000Z","2023-03-28T00:00:00.000Z","2023-03-29T00:00:00.000Z","2023-03-30T00:00:00.000Z","2023-03-31T00:00:00.000Z","2023-04-01T00:00:00.000Z","2023-04-02T00:00:00.000Z","2023-04-03T00:00:00.000Z","2023-04-04T00:00:00.000Z","2023-04-05T00:00:00.000Z","2023-04-06T00:00:00.000Z","2023-04-07T00:00:00.000Z","2023-04-08T00:00:00.000Z","2023-04-09T00:00:00.000Z","2023-04-10T00:00:00.000Z","2023-04-11T00:00:00.000Z","2023-04-12T00:00:00.000Z","2023-04-13T00:00:00.000Z","2023-04-14T00:00:00.000Z","2023-04-15T00:00:00.000Z","2023-04-16T00:00:00.000Z","2023-04-17T00:00:00.000Z","2023-04-18T00:00:00.000Z","2023-04-19T00:00:00.000Z","2023-04-20T00:00:00.000Z","2023-04-21T00:00:00.000Z","2023-04-22T00:00:00.000Z","2023-04-23T00:00:00.000Z","2023-04-24T00:00:00.000Z","2023-04-25T00:00:00.000Z","2023-04-26T00:00:00.000Z","2023-04-27T00:00:00.000Z","2023-04-28T00:00:00.000Z","2023-04-29T00:00:00.000Z","2023-04-30T00:00:00.000Z","2023-05-01T00:00:00.000Z","2023-05-02T00:00:00.000Z","2023-05-03T00:00:00.000Z","2023-05-04T00:00:00.000Z","2023-05-05T00:00:00.000Z","2023-05-06T00:00:00.000Z","2023-05-07T00:00:00.000Z","2023-05-08T00:00:00.000Z","2023-05-09T00:00:00.000Z","2023-05-10T00:00:00.000Z","2023-05-11T00:00:00.000Z","2023-05-12T00:00:00.000Z","2023-05-13T00:00:00.000Z","2023-05-14T00:00:00.000Z","2023-05-15T00:00:00.000Z","2023-05-16T00:00:00.000Z","2023-05-17T00:00:00.000Z","2023-05-18T00:00:00.000Z","2023-05-19T00:00:00.000Z","2023-05-20T00:00:00.000Z","2023-05-21T00:00:00.000Z","2023-05-22T00:00:00.000Z","2023-05-23T00:00:00.000Z","2023-05-24T00:00:00.000Z","2023-05-25T00:00:00.000Z","2023-05-26T00:00:00.000Z","2023-05-27T00:00:00.000Z","2023-05-28T00:00:00.000Z","2023-05-29T00:00:00.000Z","2023-05-30T00:00:00.000Z","2023-05-31T00:00:00.000Z","2023-06-01T00:00:00.000Z","2023-06-02T00:00:00.000Z","2023-06-03T00:00:00.000Z","2023-06-04T00:00:00.000Z","2023-06-05T00:00:00.000Z","2023-06-06T00:00:00.000Z","2023-06-07T00:00:00.000Z","2023-06-08T00:00:00.000Z","2023-06-09T00:00:00.000Z","2023-06-10T00:00:00.000Z","2023-06-11T00:00:00.000Z","2023-06-12T00:00:00.000Z","2023-06-13T00:00:00.000Z","2023-06-14T00:00:00.000Z","2023-06-15T00:00:00.000Z","2023-06-16T00:00:00.000Z","2023-06-17T00:00:00.000Z","2023-06-18T00:00:00.000Z","2023-06-19T00:00:00.000Z","2023-06-20T00:00:00.000Z","2023-06-21T00:00:00.000Z","2023-06-22T00:00:00.000Z","2023-06-23T00:00:00.000Z","2023-06-24T00:00:00.000Z","2023-06-25T00:00:00.000Z","2023-06-26T00:00:00.000Z","2023-06-27T00:00:00.000Z","2023-06-28T00:00:00.000Z","2023-06-29T00:00:00.000Z","2023-06-30T00:00:00.000Z","2023-07-01T00:00:00.000Z","2023-07-02T00:00:00.000Z","2023-07-03T00:00:00.000Z","2023-07-04T00:00:00.000Z","2023-07-05T00:00:00.000Z","2023-07-06T00:00:00.000Z","2023-07-07T00:00:00.000Z","2023-07-08T00:00:00.000Z","2023-07-09T00:00:00.000Z","2023-07-10T00:00:00.000Z","2023-07-11T00:00:00.000Z","2023-07-12T00:00:00.000Z","2023-07-13T00:00:00.000Z","2023-07-14T00:00:00.000Z","2023-07-15T00:00:00.000Z","2023-07-16T00:00:00.000Z","2023-07-17T00:00:00.000Z","2023-07-18T00:00:00.000Z","2023-07-19T00:00:00.000Z","2023-07-20T00:00:00.000Z","2023-07-21T00:00:00.000Z","2023-07-22T00:00:00.000Z","2023-07-23T00:00:00.000Z","2023-07-24T00:00:00.000Z","2023-07-25T00:00:00.000Z","2023-07-26T00:00:00.000Z","2023-07-27T00:00:00.000Z","2023-07-28T00:00:00.000Z","2023-07-29T00:00:00.000Z","2023-07-30T00:00:00.000Z","2023-07-31T00:00:00.000Z","2023-08-01T00:00:00.000Z","2023-08-02T00:00:00.000Z","2023-08-03T00:00:00.000Z","2023-08-04T00:00:00.000Z","2023-08-05T00:00:00.000Z","2023-08-06T00:00:00.000Z","2023-08-07T00:00:00.000Z","2023-08-08T00:00:00.000Z","2023-08-09T00:00:00.000Z","2023-08-10T00:00:00.000Z","2023-08-11T00:00:00.000Z","2023-08-12T00:00:00.000Z","2023-08-13T00:00:00.000Z","2023-08-14T00:00:00.000Z","2023-08-15T00:00:00.000Z","2023-08-16T00:00:00.000Z","2023-08-17T00:00:00.000Z","2023-08-18T00:00:00.000Z","2023-08-19T00:00:00.000Z","2023-08-20T00:00:00.000Z","2023-08-21T00:00:00.000Z","2023-08-22T00:00:00.000Z","2023-08-23T00:00:00.000Z","2023-08-24T00:00:00.000Z","2023-08-25T00:00:00.000Z","2023-08-26T00:00:00.000Z","2023-08-27T00:00:00.000Z","2023-08-28T00:00:00.000Z","2023-08-29T00:00:00.000Z","2023-08-30T00:00:00.000Z","2023-08-31T00:00:00.000Z","2023-09-01T00:00:00.000Z","2023-09-02T00:00:00.000Z","2023-09-03T00:00:00.000Z","2023-09-04T00:00:00.000Z","2023-09-05T00:00:00.000Z","2023-09-06T00:00:00.000Z","2023-09-07T00:00:00.000Z","2023-09-08T00:00:00.000Z","2023-09-09T00:00:00.000Z","2023-09-10T00:00:00.000Z","2023-09-11T00:00:00.000Z","2023-09-12T00:00:00.000Z","2023-09-13T00:00:00.000Z","2023-09-14T00:00:00.000Z","2023-09-15T00:00:00.000Z","2023-09-16T00:00:00.000Z","2023-09-17T00:00:00.000Z","2023-09-18T00:00:00.000Z","2023-09-19T00:00:00.000Z","2023-09-20T00:00:00.000Z","2023-09-21T00:00:00.000Z","2023-09-22T00:00:00.000Z","2023-09-23T00:00:00.000Z","2023-09-24T00:00:00.000Z","2023-09-25T00:00:00.000Z","2023-09-26T00:00:00.000Z","2023-09-27T00:00:00.000Z","2023-09-28T00:00:00.000Z","2023-09-29T00:00:00.000Z","2023-09-30T00:00:00.000Z","2023-10-01T00:00:00.000Z","2023-10-02T00:00:00.000Z","2023-10-03T00:00:00.000Z","2023-10-04T00:00:00.000Z","2023-10-05T00:00:00.000Z","2023-10-06T00:00:00.000Z","2023-10-07T00:00:00.000Z","2023-10-08T00:00:00.000Z","2023-10-09T00:00:00.000Z","2023-10-10T00:00:00.000Z","2023-10-11T00:00:00.000Z","2023-10-12T00:00:00.000Z","2023-10-13T00:00:00.000Z","2023-10-14T00:00:00.000Z","2023-10-15T00:00:00.000Z","2023-10-16T00:00:00.000Z","2023-10-17T00:00:00.000Z","2023-10-18T00:00:00.000Z","2023-10-19T00:00:00.000Z","2023-10-20T00:00:00.000Z","2023-10-21T00:00:00.000Z","2023-10-22T00:00:00.000Z","2023-10-23T00:00:00.000Z","2023-10-24T00:00:00.000Z","2023-10-25T00:00:00.000Z","2023-10-26T00:00:00.000Z","2023-10-27T00:00:00.000Z","2023-10-28T00:00:00.000Z","2023-10-29T00:00:00.000Z","2023-10-30T00:00:00.000Z","2023-10-31T00:00:00.000Z","2023-11-01T00:00:00.000Z","2023-11-02T00:00:00.000Z","2023-11-03T00:00:00.000Z","2023-11-04T00:00:00.000Z","2023-11-05T00:00:00.000Z","2023-11-06T00:00:00.000Z","2023-11-07T00:00:00.000Z","2023-11-08T00:00:00.000Z","2023-11-09T00:00:00.000Z","2023-11-10T00:00:00.000Z","2023-11-11T00:00:00.000Z","2023-11-12T00:00:00.000Z","2023-11-13T00:00:00.000Z","2023-11-14T00:00:00.000Z","2023-11-15T00:00:00.000Z","2023-11-16T00:00:00.000Z","2023-11-17T00:00:00.000Z","2023-11-18T00:00:00.000Z","2023-11-19T00:00:00.000Z","2023-11-20T00:00:00.000Z","2023-11-21T00:00:00.000Z","2023-11-22T00:00:00.000Z","2023-11-23T00:00:00.000Z","2023-11-24T00:00:00.000Z","2023-11-25T00:00:00.000Z","2023-11-26T00:00:00.000Z","2023-11-27T00:00:00.000Z","2023-11-28T00:00:00.000Z","2023-11-29T00:00:00.000Z","2023-11-30T00:00:00.000Z","2023-12-01T00:00:00.000Z","2023-12-02T00:00:00.000Z","2023-12-03T00:00:00.000Z","2023-12-04T00:00:00.000Z","2023-12-05T00:00:00.000Z","2023-12-06T00:00:00.000Z","2023-12-07T00:00:00.000Z","2023-12-08T00:00:00.000Z","2023-12-09T00:00:00.000Z","2023-12-10T00:00:00.000Z","2023-12-11T00:00:00.000Z","2023-12-12T00:00:00.000Z","2023-12-13T00:00:00.000Z","2023-12-14T00:00:00.000Z","2023-12-15T00:00:00.000Z","2023-12-16T00:00:00.000Z","2023-12-17T00:00:00.000Z","2023-12-18T00:00:00.000Z","2023-12-19T00:00:00.000Z","2023-12-20T00:00:00.000Z","2023-12-21T00:00:00.000Z","2023-12-22T00:00:00.000Z","2023-12-23T00:00:00.000Z","2023-12-24T00:00:00.000Z","2023-12-25T00:00:00.000Z","2023-12-26T00:00:00.000Z","2023-12-27T00:00:00.000Z","2023-12-28T00:00:00.000Z","2023-12-29T00:00:00.000Z","2023-12-30T00:00:00.000Z","2023-12-31T00:00:00.000Z"],[2131,2850,3038,4497,3932,3716,2874,2768,4854,6005,6344,5183,4084,3050,3096,2592,5626,5328,4417,4487,3302,1820,4134,5240,2771,3182,2515,1450,1382,2384,2576,3406,3857,2110,2684,2872,4543,5255,5340,2784,4256,3852,4263,5581,5652,5207,2229,2625,3053,4089,4515,4839,2125,4669,3654,2822,3591,3676,6162,6822,5425,3802,3779,4064,4931,5924,5890,4681,3428,3498,2123,3571,5019,5810,4999,4129,1895,2772,5144,6548,5366,5061,4883,2637,3254,5292,6595,5802,6369,4488,3413,4901,5660,5210,5423,6695,5568,5806,5234,8225,10044,10499,10709,9893,9295,3109,4218,8160,7575,8296,7947,4411,3975,6657,6017,7715,9106,7324,4774,3282,3861,7259,8220,9788,9823,7354,8064,5750,9626,10855,11074,6126,6447,4452,8526,10575,9332,10518,7976,8597,9035,10069,11644,10135,9445,8993,7762,7531,7549,11006,10989,11372,11231,10500,9133,10497,10842,11365,11082,11137,10916,4207,9449,5664,11052,10259,9370,9621,8428,9937,11507,11863,11651,11016,10397,7483,8980,9750,9834,8922,9552,7311,2083,9505,7909,7926,11184,10735,8889,9792,10934,10809,7441,11923,10263,9722,8765,10901,12454,12626,12113,11325,8702,9395,11023,11992,10887,11715,9034,10293,9645,11195,12660,12625,12305,11606,6113,6952,10542,12154,12174,11684,10701,10824,8430,5231,11052,12417,9957,11286,10619,9162,11048,12575,10279,9574,11069,9572,9215,11231,12515,12303,11988,10089,8827,7955,7701,11224,10290,11468,8059,10270,9267,4133,11721,11754,11719,10959,9015,5901,10371,7345,11923,10939,10734,10323,8665,9637,9385,10699,11427,10560,9925,9003,10774,12325,12379,10664,8226,7928,7064,8677,10262,9721,8244,5432,3958,6234,8406,10572,10516,8522,8826,7054,6532,9056,11734,7993,9117,8264,6105,3668,7206,5336,6680,8489,7893,6967,6236,9282,9167,7962,9376,7072,6000,5703,8605,9605,9675,9818,7282,5739,4660,5342,5116,4811,1995,2235,2722,1656,4311,4720,6248,7639,2898,4647,3166,5996,4724,6234,7341,6965,4617,3091,5116,5711,5865,6313,5940,1911,3120,4059,4285,5073,4830,2354,2265,1902,781,2365,3230,2209,2645,2486,1370],[1181,934,677,896,792,852,887,969,1050,1300,1444,1125,920,987,1070,638,1123,1109,805,933,998,426,627,958,420,499,410,275,266,289,402,522,617,353,663,841,824,982,1013,506,930,1517,1900,1314,1152,1099,344,526,1188,2023,1240,993,390,943,787,940,1343,915,1247,1817,1223,865,1507,1687,994,1346,1336,1034,794,1762,581,707,1309,1526,1264,1191,587,1027,1260,1678,1252,1245,1368,927,1234,1277,1636,1353,1858,1493,1361,2511,1402,1186,1647,2137,2293,3942,3610,3065,4207,4750,5294,6026,8749,1394,938,2445,2434,3210,3942,2302,1741,1907,1611,2255,3520,3021,2857,1456,795,1906,2424,3965,5479,6147,6778,1594,3625,4609,4975,2560,4067,2432,2988,4208,3443,4574,3963,7024,7740,4601,5686,4124,3927,5331,6907,7383,7106,4921,4721,5769,7337,9941,7669,5120,4530,5163,5420,6916,10588,2537,3982,1655,4997,4628,5331,9156,7041,6178,5145,5764,6019,7359,10432,6726,3768,3922,4595,4095,5962,6893,1601,7535,8520,3470,5550,6604,7691,8098,5138,4087,2599,5574,6396,9163,7700,5180,5492,6012,6344,7437,7783,8454,5321,5389,4918,5807,5359,10273,8402,5242,5844,7173,7258,8977,5028,5577,5336,5279,5496,5776,6861,10846,6958,1699,4703,5878,4740,7277,10154,8431,4751,5258,4568,4595,6279,7761,6899,4625,4991,5019,5528,6494,8840,8814,7408,4635,4187,4781,3909,8766,7714,1236,4720,4518,5038,7147,8819,4416,4067,2286,4978,4464,6046,9079,6674,3853,3497,3617,4492,5771,8617,7194,4634,5171,5656,4368,4172,6370,6690,3855,3666,3404,2834,1946,1925,3890,2446,3475,3374,2661,3891,4920,4336,2965,4277,2454,2840,3350,3256,1630,1776,1052,1556,2348,2873,4342,3421,2798,2356,2030,3519,2461,3480,2870,2428,2678,2790,3093,2462,3147,2255,1221,1163,1423,880,768,1079,392,698,801,1236,1940,749,1702,930,1137,875,1297,1718,2132,2013,1182,952,1020,1075,1498,1792,618,1123,690,788,1130,1203,600,874,844,358,735,1017,483,737,900,528]]},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>These maps track bike-sharing activity going on worldwide and in Chicago.</p>
<p><a href="https://bikesharemap.com/#/8/-87.5771/41.3747/">Bike Share Map</a> <span class="citation" data-cites="bikesha">(<a href="#ref-bikesha" role="doc-biblioref"><span>“Bike Share Map: Chicago (Divvy),”</span> n.d.</a>)</span></p>
<p><a href="https://citybik.es/">CityBikes: bike sharing networks around the world</a> <span class="citation" data-cites="citybike">(<a href="#ref-citybike" role="doc-biblioref"><span>“CityBikes: Bike Sharing Networks Around the World,”</span> n.d.</a>)</span></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'drops duckDB tables'</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># a chunk for easily dropping either all (default) or specific tables from the ddb. Also made it so you can see the current tables and then the tables after running the chunk.</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>paths <span class="ot">&lt;-</span> duckdb<span class="sc">::</span><span class="fu">dbListTables</span>(dbconn)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>paths[]</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>drops_tables <span class="ot">&lt;-</span> <span class="cf">function</span>(path) {</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    duckdb<span class="sc">::</span><span class="fu">dbRemoveTable</span>(dbconn, </span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>                          path)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>paths[] <span class="sc">|&gt;</span> purrr<span class="sc">::</span><span class="fu">walk</span>(drops_tables)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>paths <span class="ot">&lt;-</span> duckdb<span class="sc">::</span><span class="fu">dbListTables</span>(dbconn)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>paths[]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'duckDB Shutdown'</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>duckdb<span class="sc">::</span><span class="fu">dbDisconnect</span>(dbconn, <span class="at">shutdown =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">"fltrdData"</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-average2024" class="csl-entry" role="listitem">
<span>“Average Bicycle Speed <span></span> How Fast Do Cyclists Ride and What Affects Their Pace - BikingulTimate.com (UPDATE 👍).”</span> 2024. <a href="https://bikingultimate.com/average-bicycle-speed-how-fast-do-cyclists-ride-and-what-affects-their-pace/">https://bikingultimate.com/average-bicycle-speed-how-fast-do-cyclists-ride-and-what-affects-their-pace/</a>.
</div>
<div id="ref-bikesha" class="csl-entry" role="listitem">
<span>“Bike Share Map: Chicago (Divvy).”</span> n.d. <a href="https://bikesharemap.com/chicago/">https://bikesharemap.com/chicago/</a>.
</div>
<div id="ref-citybike" class="csl-entry" role="listitem">
<span>“CityBikes: Bike Sharing Networks Around the World.”</span> n.d. <a href="https://citybik.es/">https://citybik.es/</a>.
</div>
<div id="ref-datalic" class="csl-entry" role="listitem">
<span>“Data License Agreement | Divvy Bikes.”</span> n.d. <a href="https://divvybikes.com/data-license-agreement">https://divvybikes.com/data-license-agreement</a>.
</div>
<div id="ref-great-ci" class="csl-entry" role="listitem">
<span>“Great-Circle Distance - Wikipedia.”</span> n.d. <a href="https://en.wikipedia.org/wiki/Great-circle_distance">https://en.wikipedia.org/wiki/Great-circle_distance</a>.
</div>
<div id="ref-indexof" class="csl-entry" role="listitem">
<span>“Index of Bucket <span>"</span>Divvy-Tripdata<span>"</span>.”</span> n.d. <a href="https://divvy-tripdata.s3.amazonaws.com/index.html">https://divvy-tripdata.s3.amazonaws.com/index.html</a>.
</div>
<div id="ref-motivate" class="csl-entry" role="listitem">
<span>“MOTIVATE.”</span> n.d. <a href="https://motivateco.com/">https://motivateco.com/</a>.
</div>
<div id="ref-rforda" class="csl-entry" role="listitem">
<span>“R for Data Science (2e) - 22&nbsp; Arrow.”</span> n.d. <a href="https://r4ds.hadley.nz/arrow">https://r4ds.hadley.nz/arrow</a>.
</div>
<div id="ref-whyduck" class="csl-entry" role="listitem">
<span>“Why DuckDB.”</span> n.d. <a href="https://duckdb.org/why_duckdb.html">https://duckdb.org/why_duckdb.html</a>.
</div>
</div></section></div></main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImpzRGF0YSA9IHRyYW5zcG9zZShqc190c2kpXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJQbG90LnBsb3Qoe1xuICAgIGdyaWQ6IHRydWUsXG4gICAgY29sb3I6IHtsZWdlbmQ6IHRydWV9LFxuICAgIG1hcmtzOiBbXG4gICAgICAgIFBsb3QuZG90KGpzRGF0YSwge3g6ICdzdGFydGVkX2F0JywgeTogJ24nLCBmaWxsOiAnbWVtYmVyX2Nhc3VhbCd9KVxuXVxufSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlBsb3QubGluZVkoanNEYXRhLCB7eDogXCJzdGFydGVkX2F0XCIsIHk6IFwiblwifSkucGxvdCgpXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJJbnB1dHMudGFibGUoanNEYXRhLCB7XG5yb3dzOiAyMFxufSlcbiJ9XX0=
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb49" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "BikeShare"</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Eric Mossotti"</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> references.bib</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="an">repo:</span><span class="co"> https://github.com/ericMossotti/Bike_Share</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="an">page-layout:</span><span class="co"> article</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="an">source:</span><span class="co"> bikeShare.qmd</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="an">code-links:</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co">    - text: "Project Repo"</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co">      href: repo</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co">      </span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> true</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="an">code-copy:</span><span class="co"> hover</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="an">code-overflow:</span><span class="co"> wrap</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="an">toc_float:</span><span class="co"> false</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="an">smooth-scroll:</span><span class="co"> true</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="an">echo:</span><span class="co"> true</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="co">#font: merriweather, futura</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a><span class="fu"># Case Study: Bike-Sharing, Rethought</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a><span class="fu">#### References:</span></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Bike-share research (bikeshare-research.org)</span><span class="co">](https://bikeshare-research.org/#bssid:chicago)</span></span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Divvy - Wikipedia</span><span class="co">](https://en.wikipedia.org/wiki/Divvy)</span></span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Cycling in Chicago - Wikipedia</span><span class="co">](https://en.wikipedia.org/wiki/Cycling_in_Chicago)</span></span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Home \| Divvy Bikes</span><span class="co">](https://divvybikes.com/)</span></span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Divvy Membership &amp; Pass Options \| Divvy Bikes</span><span class="co">](https://divvybikes.com/pricing)</span></span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">@datalic</span><span class="co">]</span></span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="co">[</span><span class="ot">Data License Agreement \| Divvy Bikes</span><span class="co">](https://divvybikes.com/data-license-agreement)</span></span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">@motivate</span><span class="co">]</span></span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="co">[</span><span class="ot">MOTIVATE (motivateco.com)</span><span class="co">](https://motivateco.com/)</span></span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">@indexof</span><span class="co">]</span></span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-53"><a href="#cb49-53" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="co">[</span><span class="ot">Index of bucket "divvy-tripdata"</span><span class="co">](https://divvy-tripdata.s3.amazonaws.com/index.html)</span></span>
<span id="cb49-54"><a href="#cb49-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-55"><a href="#cb49-55" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">@whyduck</span><span class="co">]</span></span>
<span id="cb49-56"><a href="#cb49-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-57"><a href="#cb49-57" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="co">[</span><span class="ot">Why DuckDB?</span><span class="co">](https://duckdb.org/why_duckdb)</span></span>
<span id="cb49-58"><a href="#cb49-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-59"><a href="#cb49-59" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">@rforda</span><span class="co">]</span></span>
<span id="cb49-60"><a href="#cb49-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-61"><a href="#cb49-61" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="co">[</span><span class="ot">R for Data Science: Chapter 22: Arrow</span><span class="co">](https://r4ds.hadley.nz/arrow "Arrow")</span></span>
<span id="cb49-62"><a href="#cb49-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-63"><a href="#cb49-63" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">@great-ci</span><span class="co">]</span></span>
<span id="cb49-64"><a href="#cb49-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-65"><a href="#cb49-65" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="ot">&lt;https://en.wikipedia.org/wiki/Great-circle_distance&gt;</span></span>
<span id="cb49-66"><a href="#cb49-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-67"><a href="#cb49-67" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">@average2024</span><span class="co">]</span></span>
<span id="cb49-68"><a href="#cb49-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-69"><a href="#cb49-69" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="ot">&lt;https://bikingultimate.com/average-bicycle-speed-how-fast-do-cyclists-ride-and-what-affects-their-pace/&gt;</span></span>
<span id="cb49-70"><a href="#cb49-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-71"><a href="#cb49-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include = FALSE}</span></span>
<span id="cb49-72"><a href="#cb49-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-73"><a href="#cb49-73" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(message = FALSE, </span></span>
<span id="cb49-74"><a href="#cb49-74" aria-hidden="true" tabindex="-1"></a><span class="in">                      warning = FALSE)</span></span>
<span id="cb49-75"><a href="#cb49-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-76"><a href="#cb49-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-79"><a href="#cb49-79" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-80"><a href="#cb49-80" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: 'create lists, download zips'</span></span>
<span id="cb49-81"><a href="#cb49-81" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb49-82"><a href="#cb49-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-83"><a href="#cb49-83" aria-hidden="true" tabindex="-1"></a>durls <span class="ot">&lt;-</span></span>
<span id="cb49-84"><a href="#cb49-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"https://divvy-tripdata.s3.amazonaws.com/%d-divvy-tripdata.zip"</span>,</span>
<span id="cb49-85"><a href="#cb49-85" aria-hidden="true" tabindex="-1"></a>            <span class="dv">202301</span><span class="sc">:</span><span class="dv">202312</span>)</span>
<span id="cb49-86"><a href="#cb49-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-87"><a href="#cb49-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Need some directories to store the files. </span></span>
<span id="cb49-88"><a href="#cb49-88" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"tempZips"</span>)</span>
<span id="cb49-89"><a href="#cb49-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-90"><a href="#cb49-90" aria-hidden="true" tabindex="-1"></a>tempZipPaths <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"tempZips/%d-divvy-tripdata.zip"</span>,</span>
<span id="cb49-91"><a href="#cb49-91" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">202301</span><span class="sc">:</span><span class="dv">202312</span>)</span>
<span id="cb49-92"><a href="#cb49-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-93"><a href="#cb49-93" aria-hidden="true" tabindex="-1"></a><span class="co"># A simple way to download and relocate several files. </span></span>
<span id="cb49-94"><a href="#cb49-94" aria-hidden="true" tabindex="-1"></a>curl<span class="sc">::</span><span class="fu">multi_download</span>(durls,</span>
<span id="cb49-95"><a href="#cb49-95" aria-hidden="true" tabindex="-1"></a>                     <span class="at">destfiles =</span> tempZipPaths)</span>
<span id="cb49-96"><a href="#cb49-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-97"><a href="#cb49-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-100"><a href="#cb49-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-101"><a href="#cb49-101" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'dir + lists for unz function'</span></span>
<span id="cb49-102"><a href="#cb49-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-103"><a href="#cb49-103" aria-hidden="true" tabindex="-1"></a><span class="co"># create tempFile directory</span></span>
<span id="cb49-104"><a href="#cb49-104" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"tempFiles"</span>)</span>
<span id="cb49-105"><a href="#cb49-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-106"><a href="#cb49-106" aria-hidden="true" tabindex="-1"></a><span class="co"># create list of tempFile directory paths</span></span>
<span id="cb49-107"><a href="#cb49-107" aria-hidden="true" tabindex="-1"></a>tempfile_paths <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"tempFiles/%d-divvy-tripdata.csv"</span>,</span>
<span id="cb49-108"><a href="#cb49-108" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">202301</span><span class="sc">:</span><span class="dv">202312</span>)</span>
<span id="cb49-109"><a href="#cb49-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-110"><a href="#cb49-110" aria-hidden="true" tabindex="-1"></a><span class="co"># create CSV file relocation directory</span></span>
<span id="cb49-111"><a href="#cb49-111" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"tripdata"</span>)</span>
<span id="cb49-112"><a href="#cb49-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-113"><a href="#cb49-113" aria-hidden="true" tabindex="-1"></a><span class="co"># create CSV file relocation paths</span></span>
<span id="cb49-114"><a href="#cb49-114" aria-hidden="true" tabindex="-1"></a>fileList <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"tripdata/%d-divvy-tripdata.csv"</span>,</span>
<span id="cb49-115"><a href="#cb49-115" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">202301</span><span class="sc">:</span><span class="dv">202312</span>)</span>
<span id="cb49-116"><a href="#cb49-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-117"><a href="#cb49-117" aria-hidden="true" tabindex="-1"></a><span class="co"># create CSV list to specify for unzipping</span></span>
<span id="cb49-118"><a href="#cb49-118" aria-hidden="true" tabindex="-1"></a>fileNames <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%d-divvy-tripdata.csv"</span>,</span>
<span id="cb49-119"><a href="#cb49-119" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">202301</span><span class="sc">:</span><span class="dv">202312</span>)</span>
<span id="cb49-120"><a href="#cb49-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-121"><a href="#cb49-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-124"><a href="#cb49-124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-125"><a href="#cb49-125" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: 'view the new directory-file lists'</span></span>
<span id="cb49-126"><a href="#cb49-126" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb49-127"><a href="#cb49-127" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb49-128"><a href="#cb49-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-129"><a href="#cb49-129" aria-hidden="true" tabindex="-1"></a><span class="co"># review address info that was just created</span></span>
<span id="cb49-130"><a href="#cb49-130" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="st">"URLs"</span> <span class="ot">=</span> durls,</span>
<span id="cb49-131"><a href="#cb49-131" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Zip File Paths"</span> <span class="ot">=</span> tempZipPaths,</span>
<span id="cb49-132"><a href="#cb49-132" aria-hidden="true" tabindex="-1"></a>               <span class="st">"File Names"</span> <span class="ot">=</span> fileNames,</span>
<span id="cb49-133"><a href="#cb49-133" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Parquet File Paths"</span> <span class="ot">=</span> tempfile_paths)</span>
<span id="cb49-134"><a href="#cb49-134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-135"><a href="#cb49-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-138"><a href="#cb49-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-139"><a href="#cb49-139" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'unzip and relocate function'</span></span>
<span id="cb49-140"><a href="#cb49-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-141"><a href="#cb49-141" aria-hidden="true" tabindex="-1"></a><span class="co"># A custom function that makes unzipping, converting and relocating files all at once, simple. </span></span>
<span id="cb49-142"><a href="#cb49-142" aria-hidden="true" tabindex="-1"></a>unz_relocate <span class="ot">&lt;-</span> <span class="cf">function</span> (<span class="at">x =</span> tempfile_paths,</span>
<span id="cb49-143"><a href="#cb49-143" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> tempZipPaths,</span>
<span id="cb49-144"><a href="#cb49-144" aria-hidden="true" tabindex="-1"></a>                          <span class="at">z =</span> fileNames) {</span>
<span id="cb49-145"><a href="#cb49-145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(x)) {</span>
<span id="cb49-146"><a href="#cb49-146" aria-hidden="true" tabindex="-1"></a>        utils<span class="sc">::</span><span class="fu">unzip</span>(y[i],</span>
<span id="cb49-147"><a href="#cb49-147" aria-hidden="true" tabindex="-1"></a>                     z[i])</span>
<span id="cb49-148"><a href="#cb49-148" aria-hidden="true" tabindex="-1"></a>        <span class="fu">file.rename</span>(z[i],</span>
<span id="cb49-149"><a href="#cb49-149" aria-hidden="true" tabindex="-1"></a>                    x[i])</span>
<span id="cb49-150"><a href="#cb49-150" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb49-151"><a href="#cb49-151" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-152"><a href="#cb49-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-153"><a href="#cb49-153" aria-hidden="true" tabindex="-1"></a><span class="fu">unz_relocate</span>()</span>
<span id="cb49-154"><a href="#cb49-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-155"><a href="#cb49-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-158"><a href="#cb49-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-159"><a href="#cb49-159" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'remove zips folder from working directory'</span></span>
<span id="cb49-160"><a href="#cb49-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-161"><a href="#cb49-161" aria-hidden="true" tabindex="-1"></a><span class="co"># To remove stored files</span></span>
<span id="cb49-162"><a href="#cb49-162" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">"tempZips"</span>,</span>
<span id="cb49-163"><a href="#cb49-163" aria-hidden="true" tabindex="-1"></a>       <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-164"><a href="#cb49-164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-165"><a href="#cb49-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-168"><a href="#cb49-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-169"><a href="#cb49-169" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'create tibble from temp CSV'</span></span>
<span id="cb49-170"><a href="#cb49-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-171"><a href="#cb49-171" aria-hidden="true" tabindex="-1"></a>tripTibble <span class="ot">&lt;-</span> </span>
<span id="cb49-172"><a href="#cb49-172" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">map</span>(tempfile_paths[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>],</span>
<span id="cb49-173"><a href="#cb49-173" aria-hidden="true" tabindex="-1"></a>                         arrow<span class="sc">::</span>read_csv_arrow) <span class="sc">|&gt;</span></span>
<span id="cb49-174"><a href="#cb49-174" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">list_rbind</span>()</span>
<span id="cb49-175"><a href="#cb49-175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-176"><a href="#cb49-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-179"><a href="#cb49-179" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-180"><a href="#cb49-180" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'count raw obs, then drop NAs'</span></span>
<span id="cb49-181"><a href="#cb49-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-182"><a href="#cb49-182" aria-hidden="true" tabindex="-1"></a><span class="co"># Need to save this count for later before I drop the incomplete obs</span></span>
<span id="cb49-183"><a href="#cb49-183" aria-hidden="true" tabindex="-1"></a>original_nobs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(tripTibble)</span>
<span id="cb49-184"><a href="#cb49-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-185"><a href="#cb49-185" aria-hidden="true" tabindex="-1"></a>tripTibble <span class="ot">&lt;-</span> tripTibble <span class="sc">|&gt;</span></span>
<span id="cb49-186"><a href="#cb49-186" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb49-187"><a href="#cb49-187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-188"><a href="#cb49-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-191"><a href="#cb49-191" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-192"><a href="#cb49-192" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'new calculated column for trip time'</span></span>
<span id="cb49-193"><a href="#cb49-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-194"><a href="#cb49-194" aria-hidden="true" tabindex="-1"></a><span class="co"># To make use of supplied trip interval data</span></span>
<span id="cb49-195"><a href="#cb49-195" aria-hidden="true" tabindex="-1"></a>tripTibble <span class="sc">|&gt;</span></span>
<span id="cb49-196"><a href="#cb49-196" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">"trip_time"</span> <span class="ot">=</span> lubridate<span class="sc">::</span><span class="fu">time_length</span>(</span>
<span id="cb49-197"><a href="#cb49-197" aria-hidden="true" tabindex="-1"></a>        lubridate<span class="sc">::</span><span class="fu">interval</span>(started_at,</span>
<span id="cb49-198"><a href="#cb49-198" aria-hidden="true" tabindex="-1"></a>                            ended_at),</span>
<span id="cb49-199"><a href="#cb49-199" aria-hidden="true" tabindex="-1"></a>        <span class="at">unit =</span> <span class="st">"minute"</span>), </span>
<span id="cb49-200"><a href="#cb49-200" aria-hidden="true" tabindex="-1"></a>        <span class="at">.keep =</span> <span class="st">"all"</span></span>
<span id="cb49-201"><a href="#cb49-201" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb49-202"><a href="#cb49-202" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">write_dataset</span>(<span class="st">"tempFiles"</span>,</span>
<span id="cb49-203"><a href="#cb49-203" aria-hidden="true" tabindex="-1"></a>                         <span class="at">existing_data_behavior =</span> <span class="st">"delete"</span>)</span>
<span id="cb49-204"><a href="#cb49-204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-205"><a href="#cb49-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-208"><a href="#cb49-208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-209"><a href="#cb49-209" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'removing large tibble from memory'</span></span>
<span id="cb49-210"><a href="#cb49-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-211"><a href="#cb49-211" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tripTibble)</span>
<span id="cb49-212"><a href="#cb49-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-213"><a href="#cb49-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-216"><a href="#cb49-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-217"><a href="#cb49-217" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'create and view list of files'</span></span>
<span id="cb49-218"><a href="#cb49-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-219"><a href="#cb49-219" aria-hidden="true" tabindex="-1"></a>fileList <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"tempFiles"</span>,</span>
<span id="cb49-220"><a href="#cb49-220" aria-hidden="true" tabindex="-1"></a>                              <span class="at">full.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb49-221"><a href="#cb49-221" aria-hidden="true" tabindex="-1"></a>                              <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-222"><a href="#cb49-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-223"><a href="#cb49-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-226"><a href="#cb49-226" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-227"><a href="#cb49-227" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb49-228"><a href="#cb49-228" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb49-229"><a href="#cb49-229" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb49-230"><a href="#cb49-230" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Files now in tempFiles: "</span>,</span>
<span id="cb49-231"><a href="#cb49-231" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb49-232"><a href="#cb49-232" aria-hidden="true" tabindex="-1"></a>    fileList)</span>
<span id="cb49-233"><a href="#cb49-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-234"><a href="#cb49-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-237"><a href="#cb49-237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-238"><a href="#cb49-238" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'create/write a parquet file dataset'</span></span>
<span id="cb49-239"><a href="#cb49-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-240"><a href="#cb49-240" aria-hidden="true" tabindex="-1"></a>tripset <span class="ot">&lt;-</span> arrow<span class="sc">::</span><span class="fu">open_dataset</span>(<span class="at">sources =</span> fileList[<span class="dv">1</span>],</span>
<span id="cb49-241"><a href="#cb49-241" aria-hidden="true" tabindex="-1"></a>                               <span class="at">format =</span> <span class="st">"parquet"</span>)</span>
<span id="cb49-242"><a href="#cb49-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-243"><a href="#cb49-243" aria-hidden="true" tabindex="-1"></a>tripset <span class="sc">|&gt;</span> arrow<span class="sc">::</span><span class="fu">write_dataset</span>(<span class="at">path =</span> <span class="st">"tripdata"</span>,</span>
<span id="cb49-244"><a href="#cb49-244" aria-hidden="true" tabindex="-1"></a>                                <span class="at">format =</span> <span class="st">"parquet"</span>)</span>
<span id="cb49-245"><a href="#cb49-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-246"><a href="#cb49-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-249"><a href="#cb49-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-250"><a href="#cb49-250" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: 'view arrow dataset content'</span></span>
<span id="cb49-251"><a href="#cb49-251" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb49-252"><a href="#cb49-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-253"><a href="#cb49-253" aria-hidden="true" tabindex="-1"></a>tripset <span class="sc">|&gt;</span></span>
<span id="cb49-254"><a href="#cb49-254" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-255"><a href="#cb49-255" aria-hidden="true" tabindex="-1"></a>    polars<span class="sc">::</span><span class="fu">as_polars_df</span>()</span>
<span id="cb49-256"><a href="#cb49-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-257"><a href="#cb49-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-260"><a href="#cb49-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-261"><a href="#cb49-261" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'delete CSV directory'</span></span>
<span id="cb49-262"><a href="#cb49-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-263"><a href="#cb49-263" aria-hidden="true" tabindex="-1"></a><span class="co"># all files and folders</span></span>
<span id="cb49-264"><a href="#cb49-264" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">"tempFiles"</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-265"><a href="#cb49-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-266"><a href="#cb49-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-269"><a href="#cb49-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-270"><a href="#cb49-270" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'open parquet file dataset'</span></span>
<span id="cb49-271"><a href="#cb49-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-272"><a href="#cb49-272" aria-hidden="true" tabindex="-1"></a>tripset <span class="ot">&lt;-</span> arrow<span class="sc">::</span><span class="fu">open_dataset</span>(<span class="at">sources =</span> <span class="st">"tripdata"</span>,</span>
<span id="cb49-273"><a href="#cb49-273" aria-hidden="true" tabindex="-1"></a>                              <span class="at">format =</span> <span class="st">"parquet"</span>)</span>
<span id="cb49-274"><a href="#cb49-274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-275"><a href="#cb49-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-278"><a href="#cb49-278" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-279"><a href="#cb49-279" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'create/view list of parquets'</span></span>
<span id="cb49-280"><a href="#cb49-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-281"><a href="#cb49-281" aria-hidden="true" tabindex="-1"></a><span class="co"># To verify the location of the extracted data.</span></span>
<span id="cb49-282"><a href="#cb49-282" aria-hidden="true" tabindex="-1"></a>fileList <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"tripdata"</span>,</span>
<span id="cb49-283"><a href="#cb49-283" aria-hidden="true" tabindex="-1"></a>                              <span class="at">full.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb49-284"><a href="#cb49-284" aria-hidden="true" tabindex="-1"></a>                              <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-285"><a href="#cb49-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-286"><a href="#cb49-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-289"><a href="#cb49-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-290"><a href="#cb49-290" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb49-291"><a href="#cb49-291" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb49-292"><a href="#cb49-292" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb49-293"><a href="#cb49-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-294"><a href="#cb49-294" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Files in ~/tripdata: "</span>,</span>
<span id="cb49-295"><a href="#cb49-295" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb49-296"><a href="#cb49-296" aria-hidden="true" tabindex="-1"></a>    fileList)</span>
<span id="cb49-297"><a href="#cb49-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-298"><a href="#cb49-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-301"><a href="#cb49-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-302"><a href="#cb49-302" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'create dupe-table, count n distinct'</span></span>
<span id="cb49-303"><a href="#cb49-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-304"><a href="#cb49-304" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a separate table used to analyze the observations returned as not distinct (n &gt; 1). This adds an extra column labeled "n".</span></span>
<span id="cb49-305"><a href="#cb49-305" aria-hidden="true" tabindex="-1"></a>dupeTable <span class="ot">&lt;-</span> tripset <span class="sc">|&gt;</span></span>
<span id="cb49-306"><a href="#cb49-306" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">to_duckdb</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-307"><a href="#cb49-307" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(started_at<span class="sc">:</span>end_station_name) <span class="sc">|&gt;</span></span>
<span id="cb49-308"><a href="#cb49-308" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Counts of unique rows added for column 'n'</span></span>
<span id="cb49-309"><a href="#cb49-309" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">add_count</span>(started_at,</span>
<span id="cb49-310"><a href="#cb49-310" aria-hidden="true" tabindex="-1"></a>                     ended_at,</span>
<span id="cb49-311"><a href="#cb49-311" aria-hidden="true" tabindex="-1"></a>                     start_station_name,</span>
<span id="cb49-312"><a href="#cb49-312" aria-hidden="true" tabindex="-1"></a>                     end_station_name) <span class="sc">|&gt;</span></span>
<span id="cb49-313"><a href="#cb49-313" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Only observations that have been duplicated 1 or more </span></span>
<span id="cb49-314"><a href="#cb49-314" aria-hidden="true" tabindex="-1"></a>    <span class="co"># times are shown</span></span>
<span id="cb49-315"><a href="#cb49-315" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-316"><a href="#cb49-316" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We want to see all rows, not just one row for each obs</span></span>
<span id="cb49-317"><a href="#cb49-317" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-318"><a href="#cb49-318" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(started_at) <span class="sc">|&gt;</span></span>
<span id="cb49-319"><a href="#cb49-319" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>()</span>
<span id="cb49-320"><a href="#cb49-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-321"><a href="#cb49-321" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> dupeTable <span class="sc">|&gt;</span> </span>
<span id="cb49-322"><a href="#cb49-322" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(n) <span class="sc">|&gt;</span></span>
<span id="cb49-323"><a href="#cb49-323" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.integer</span>()</span>
<span id="cb49-324"><a href="#cb49-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-325"><a href="#cb49-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-326"><a href="#cb49-326" aria-hidden="true" tabindex="-1"></a>We started with 5,719,877 observations (obs) for dates spanning January to December, 2023, then removed 1,388,170 incomplete obs.</span>
<span id="cb49-327"><a href="#cb49-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-328"><a href="#cb49-328" aria-hidden="true" tabindex="-1"></a>Of the other columns, it seems that the start_time, end_time, start_station, and end_station could show if there are possibly hidden duplicated observations. Those 4 variables combined results in the most granular view of any one observation. Meaning, that data would naturally only have duplicates in error.</span>
<span id="cb49-329"><a href="#cb49-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-330"><a href="#cb49-330" aria-hidden="true" tabindex="-1"></a>I assumed that having the same times/dates and stations for two different ride IDs was a mistake. Although, I do not know how that error would happen. I could have assumed one person could check out multiple bikes at once. In that instance, each bike could be assigned a unique ride_id. That, however, has only happened 18 times over a year. Since it's only one copy every time, that also raises a red flag. I did not notice any other correlations with station_id/name, member_casual, or ride_type for those particular duplicated data.</span>
<span id="cb49-331"><a href="#cb49-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-334"><a href="#cb49-334" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-335"><a href="#cb49-335" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'output to distinct duplicates and total obs'</span></span>
<span id="cb49-336"><a href="#cb49-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-337"><a href="#cb49-337" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">" Distinct copy count of dupes: "</span>, n,</span>
<span id="cb49-338"><a href="#cb49-338" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb49-339"><a href="#cb49-339" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Total observations that have and are duplicates: "</span>,</span>
<span id="cb49-340"><a href="#cb49-340" aria-hidden="true" tabindex="-1"></a>       <span class="fu">length</span>(dupeTable[[<span class="dv">1</span>]]))</span>
<span id="cb49-341"><a href="#cb49-341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-342"><a href="#cb49-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-343"><a href="#cb49-343" aria-hidden="true" tabindex="-1"></a>By applying distinct() on dupeTable, we see the only distinct value is 2. We can safely conclude that, of the duplicates, each has a minimum and maximum of 1 extra copy.</span>
<span id="cb49-344"><a href="#cb49-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-345"><a href="#cb49-345" aria-hidden="true" tabindex="-1"></a>Number of rows in the dupeTable is 36. Because each duplicated observation has one duplicate (n = 2), expected removed nobs is 18. The issue is that we need to get rid of not all 36 rows, but just the 1 extra duplicate observation from each, resulting in the expected 18.</span>
<span id="cb49-346"><a href="#cb49-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-349"><a href="#cb49-349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-350"><a href="#cb49-350" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'create un-duped table, count rows'</span></span>
<span id="cb49-351"><a href="#cb49-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-352"><a href="#cb49-352" aria-hidden="true" tabindex="-1"></a><span class="co"># The issue is, we need to get rid of not all of these rows, but just the extra duplicate observations. </span></span>
<span id="cb49-353"><a href="#cb49-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-354"><a href="#cb49-354" aria-hidden="true" tabindex="-1"></a><span class="co"># If there were 2 rows of duplicates, we would want to end up with 1 row after removing the extras.</span></span>
<span id="cb49-355"><a href="#cb49-355" aria-hidden="true" tabindex="-1"></a>undupedTable <span class="ot">&lt;-</span> dupeTable <span class="sc">|&gt;</span></span>
<span id="cb49-356"><a href="#cb49-356" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">to_duckdb</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-357"><a href="#cb49-357" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(started_at,</span>
<span id="cb49-358"><a href="#cb49-358" aria-hidden="true" tabindex="-1"></a>                     start_station_name,</span>
<span id="cb49-359"><a href="#cb49-359" aria-hidden="true" tabindex="-1"></a>                     ended_at,</span>
<span id="cb49-360"><a href="#cb49-360" aria-hidden="true" tabindex="-1"></a>                     end_station_name,</span>
<span id="cb49-361"><a href="#cb49-361" aria-hidden="true" tabindex="-1"></a>                     <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-362"><a href="#cb49-362" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>()</span>
<span id="cb49-363"><a href="#cb49-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-364"><a href="#cb49-364" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> undupedTable <span class="sc">|&gt;</span></span>
<span id="cb49-365"><a href="#cb49-365" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(started_at) <span class="sc">|&gt;</span></span>
<span id="cb49-366"><a href="#cb49-366" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-367"><a href="#cb49-367" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-368"><a href="#cb49-368" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.integer</span>()</span>
<span id="cb49-369"><a href="#cb49-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-370"><a href="#cb49-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-373"><a href="#cb49-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-374"><a href="#cb49-374" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'output distinct obs, n'</span></span>
<span id="cb49-375"><a href="#cb49-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-376"><a href="#cb49-376" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Count of distinct observations: "</span>, n)</span>
<span id="cb49-377"><a href="#cb49-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-378"><a href="#cb49-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-379"><a href="#cb49-379" aria-hidden="true" tabindex="-1"></a>The count of observed distinct values for the un-duplicated table was indeed 18. So now, it is time to run a count of how rows/observations are in the dataset. There is a difference, though, concerning the correct amount.</span>
<span id="cb49-380"><a href="#cb49-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-383"><a href="#cb49-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-384"><a href="#cb49-384" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'incorrect/correct distinct observations'</span></span>
<span id="cb49-385"><a href="#cb49-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-386"><a href="#cb49-386" aria-hidden="true" tabindex="-1"></a><span class="co"># Run an incorrect count on how many rows or observations there are in the dataset.</span></span>
<span id="cb49-387"><a href="#cb49-387" aria-hidden="true" tabindex="-1"></a>incorrectDistinct <span class="ot">&lt;-</span> tripset <span class="sc">|&gt;</span></span>
<span id="cb49-388"><a href="#cb49-388" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">to_duckdb</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-389"><a href="#cb49-389" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(dplyr<span class="sc">::</span><span class="fu">pick</span>(<span class="st">"ride_id"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb49-390"><a href="#cb49-390" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>(<span class="at">name =</span> <span class="st">"Incorrect Distinct Observations"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-391"><a href="#cb49-391" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-392"><a href="#cb49-392" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.integer</span>()</span>
<span id="cb49-393"><a href="#cb49-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-394"><a href="#cb49-394" aria-hidden="true" tabindex="-1"></a><span class="co"># For the correct count of obs</span></span>
<span id="cb49-395"><a href="#cb49-395" aria-hidden="true" tabindex="-1"></a>correctDistinct <span class="ot">&lt;-</span> tripset <span class="sc">|&gt;</span></span>
<span id="cb49-396"><a href="#cb49-396" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">to_duckdb</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-397"><a href="#cb49-397" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(</span>
<span id="cb49-398"><a href="#cb49-398" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">pick</span>(</span>
<span id="cb49-399"><a href="#cb49-399" aria-hidden="true" tabindex="-1"></a>            <span class="st">"started_at"</span>,</span>
<span id="cb49-400"><a href="#cb49-400" aria-hidden="true" tabindex="-1"></a>            <span class="st">"start_station_name"</span>,</span>
<span id="cb49-401"><a href="#cb49-401" aria-hidden="true" tabindex="-1"></a>            <span class="st">"ended_at"</span>,</span>
<span id="cb49-402"><a href="#cb49-402" aria-hidden="true" tabindex="-1"></a>            <span class="st">"end_station_name"</span></span>
<span id="cb49-403"><a href="#cb49-403" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb49-404"><a href="#cb49-404" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb49-405"><a href="#cb49-405" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-406"><a href="#cb49-406" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-407"><a href="#cb49-407" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.integer</span>()</span>
<span id="cb49-408"><a href="#cb49-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-409"><a href="#cb49-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-412"><a href="#cb49-412" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-413"><a href="#cb49-413" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: 'duplicate correction tibb'</span></span>
<span id="cb49-414"><a href="#cb49-414" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Summary of observations removed by processing."</span></span>
<span id="cb49-415"><a href="#cb49-415" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap-location: margin</span></span>
<span id="cb49-416"><a href="#cb49-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: body-outset</span></span>
<span id="cb49-417"><a href="#cb49-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-418"><a href="#cb49-418" aria-hidden="true" tabindex="-1"></a><span class="co"># To visualize a summary of what we just determined regarding obs</span></span>
<span id="cb49-419"><a href="#cb49-419" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb49-420"><a href="#cb49-420" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Original Obs"</span> <span class="ot">=</span> original_nobs,</span>
<span id="cb49-421"><a href="#cb49-421" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Uncorrected Complete Obs"</span> <span class="ot">=</span> incorrectDistinct,</span>
<span id="cb49-422"><a href="#cb49-422" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Corrected Complete Obs"</span> <span class="ot">=</span> correctDistinct,</span>
<span id="cb49-423"><a href="#cb49-423" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Removed Obs"</span> <span class="ot">=</span> (incorrectDistinct <span class="sc">-</span> correctDistinct)</span>
<span id="cb49-424"><a href="#cb49-424" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb49-425"><a href="#cb49-425" aria-hidden="true" tabindex="-1"></a>    polars<span class="sc">::</span><span class="fu">as_polars_df</span>()</span>
<span id="cb49-426"><a href="#cb49-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-427"><a href="#cb49-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-428"><a href="#cb49-428" aria-hidden="true" tabindex="-1"></a>The incorrect number of observations (nobs) was 4,331,707. The correct nobs after removing duplicated obs was 4,331,689. In short, 18 additional obs were removed.</span>
<span id="cb49-429"><a href="#cb49-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-432"><a href="#cb49-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-433"><a href="#cb49-433" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: 'overwrite file with correct obs'</span></span>
<span id="cb49-434"><a href="#cb49-434" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: body-outset</span></span>
<span id="cb49-435"><a href="#cb49-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-436"><a href="#cb49-436" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the data to a file to ensure we have a copy free from incomplete and duplicated obs.</span></span>
<span id="cb49-437"><a href="#cb49-437" aria-hidden="true" tabindex="-1"></a>tripset <span class="sc">|&gt;</span></span>
<span id="cb49-438"><a href="#cb49-438" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(ride_id<span class="sc">:</span>trip_time) <span class="sc">|&gt;</span></span>
<span id="cb49-439"><a href="#cb49-439" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">to_duckdb</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-440"><a href="#cb49-440" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(started_at, </span>
<span id="cb49-441"><a href="#cb49-441" aria-hidden="true" tabindex="-1"></a>                    start_station_name, </span>
<span id="cb49-442"><a href="#cb49-442" aria-hidden="true" tabindex="-1"></a>                    ended_at,</span>
<span id="cb49-443"><a href="#cb49-443" aria-hidden="true" tabindex="-1"></a>                    end_station_name, </span>
<span id="cb49-444"><a href="#cb49-444" aria-hidden="true" tabindex="-1"></a>                    <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-445"><a href="#cb49-445" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(started_at) <span class="sc">|&gt;</span></span>
<span id="cb49-446"><a href="#cb49-446" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-447"><a href="#cb49-447" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">write_dataset</span>(</span>
<span id="cb49-448"><a href="#cb49-448" aria-hidden="true" tabindex="-1"></a>        <span class="at">path =</span> <span class="st">"tripdata"</span>,</span>
<span id="cb49-449"><a href="#cb49-449" aria-hidden="true" tabindex="-1"></a>        <span class="at">format =</span> <span class="st">"parquet"</span>,</span>
<span id="cb49-450"><a href="#cb49-450" aria-hidden="true" tabindex="-1"></a>        <span class="at">existing_data_behavior =</span> <span class="st">"overwrite"</span></span>
<span id="cb49-451"><a href="#cb49-451" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-452"><a href="#cb49-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-453"><a href="#cb49-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-454"><a href="#cb49-454" aria-hidden="true" tabindex="-1"></a>Noting that it was useful for me to retain certain rows at first to determine if there were duplicates.</span>
<span id="cb49-455"><a href="#cb49-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-458"><a href="#cb49-458" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-459"><a href="#cb49-459" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb49-460"><a href="#cb49-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-461"><a href="#cb49-461" aria-hidden="true" tabindex="-1"></a>tripset <span class="ot">&lt;-</span> arrow<span class="sc">::</span><span class="fu">open_dataset</span>(<span class="st">"tripdata"</span>,</span>
<span id="cb49-462"><a href="#cb49-462" aria-hidden="true" tabindex="-1"></a>                               <span class="at">format =</span> <span class="st">"parquet"</span>)</span>
<span id="cb49-463"><a href="#cb49-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-464"><a href="#cb49-464" aria-hidden="true" tabindex="-1"></a>dbconn <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(duckdb<span class="sc">::</span><span class="fu">duckdb</span>())</span>
<span id="cb49-465"><a href="#cb49-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-466"><a href="#cb49-466" aria-hidden="true" tabindex="-1"></a><span class="co"># For querying the arrow dataset with the benefits of an OLAP database. </span></span>
<span id="cb49-467"><a href="#cb49-467" aria-hidden="true" tabindex="-1"></a>duckdb<span class="sc">::</span><span class="fu">duckdb_register_arrow</span>(dbconn,</span>
<span id="cb49-468"><a href="#cb49-468" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"unfltrd_tripData"</span>,</span>
<span id="cb49-469"><a href="#cb49-469" aria-hidden="true" tabindex="-1"></a>                              tripset)</span>
<span id="cb49-470"><a href="#cb49-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-471"><a href="#cb49-471" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb49-472"><a href="#cb49-472" aria-hidden="true" tabindex="-1"></a>           <span class="st">"unfltrd_tripData"</span>)</span>
<span id="cb49-473"><a href="#cb49-473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-474"><a href="#cb49-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-475"><a href="#cb49-475" aria-hidden="true" tabindex="-1"></a><span class="fu">## Filtering Data, Smartly</span></span>
<span id="cb49-476"><a href="#cb49-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-477"><a href="#cb49-477" aria-hidden="true" tabindex="-1"></a>To ensure the conclusions are accurate, outliers should be filtered. Negative and very low trip times might skew trends. The underlying reason for very low trip times is somewhat of an unknown. Perhaps people often change their minds?</span>
<span id="cb49-478"><a href="#cb49-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-481"><a href="#cb49-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-482"><a href="#cb49-482" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'add/filter distances and speed'</span></span>
<span id="cb49-483"><a href="#cb49-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-484"><a href="#cb49-484" aria-hidden="true" tabindex="-1"></a><span class="co"># imposing sensible limits on the data we wish to include moving forward</span></span>
<span id="cb49-485"><a href="#cb49-485" aria-hidden="true" tabindex="-1"></a><span class="co"># might as well calculate distance traveled while at it</span></span>
<span id="cb49-486"><a href="#cb49-486" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb49-487"><a href="#cb49-487" aria-hidden="true" tabindex="-1"></a>           <span class="st">"unfltrd_tripData"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-488"><a href="#cb49-488" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(trip_time <span class="sc">&gt;</span> <span class="dv">1</span>,</span>
<span id="cb49-489"><a href="#cb49-489" aria-hidden="true" tabindex="-1"></a>                  trip_time <span class="sc">&lt;</span> <span class="dv">480</span>,</span>
<span id="cb49-490"><a href="#cb49-490" aria-hidden="true" tabindex="-1"></a>                  rideable_type <span class="sc">!=</span> <span class="st">"docked_bike"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-491"><a href="#cb49-491" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-492"><a href="#cb49-492" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb49-493"><a href="#cb49-493" aria-hidden="true" tabindex="-1"></a>        <span class="at">miles =</span> geosphere<span class="sc">::</span><span class="fu">distGeo</span>(</span>
<span id="cb49-494"><a href="#cb49-494" aria-hidden="true" tabindex="-1"></a>            <span class="at">p1 =</span> <span class="fu">cbind</span>(start_lng, start_lat),</span>
<span id="cb49-495"><a href="#cb49-495" aria-hidden="true" tabindex="-1"></a>            <span class="at">p2 =</span> <span class="fu">cbind</span>(end_lng, end_lat)</span>
<span id="cb49-496"><a href="#cb49-496" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">/</span> <span class="dv">1000</span> <span class="sc">*</span> <span class="fl">0.62137119</span>,</span>
<span id="cb49-497"><a href="#cb49-497" aria-hidden="true" tabindex="-1"></a>        <span class="at">mph =</span> (miles <span class="sc">/</span> (trip_time <span class="sc">/</span> <span class="dv">60</span>))</span>
<span id="cb49-498"><a href="#cb49-498" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb49-499"><a href="#cb49-499" aria-hidden="true" tabindex="-1"></a>    <span class="co"># It's somewhat nonsensical to rent a bike for distances easily walked. </span></span>
<span id="cb49-500"><a href="#cb49-500" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Also, there could be randomly generated data.</span></span>
<span id="cb49-501"><a href="#cb49-501" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(miles <span class="sc">&gt;</span> <span class="fl">0.1</span>,</span>
<span id="cb49-502"><a href="#cb49-502" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># Seems that pro cyclists average around 20 mph, </span></span>
<span id="cb49-503"><a href="#cb49-503" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># so I set that as the ceiling.</span></span>
<span id="cb49-504"><a href="#cb49-504" aria-hidden="true" tabindex="-1"></a>                  mph <span class="sc">&lt;</span> <span class="dv">21</span>,</span>
<span id="cb49-505"><a href="#cb49-505" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># To account for time spent idling, stoplights and traffic.</span></span>
<span id="cb49-506"><a href="#cb49-506" aria-hidden="true" tabindex="-1"></a>                  mph <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-507"><a href="#cb49-507" aria-hidden="true" tabindex="-1"></a>    duckdb<span class="sc">::</span><span class="fu">dbWriteTable</span>(<span class="at">conn =</span> dbconn,</span>
<span id="cb49-508"><a href="#cb49-508" aria-hidden="true" tabindex="-1"></a>                         <span class="at">name =</span> <span class="st">"fltrd_tripData"</span>)</span>
<span id="cb49-509"><a href="#cb49-509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-510"><a href="#cb49-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-511"><a href="#cb49-511" aria-hidden="true" tabindex="-1"></a>Writing the Filtered Parquet File</span>
<span id="cb49-512"><a href="#cb49-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-515"><a href="#cb49-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-516"><a href="#cb49-516" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'write fltrdData parquet'</span></span>
<span id="cb49-517"><a href="#cb49-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-518"><a href="#cb49-518" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"fltrdData"</span>)</span>
<span id="cb49-519"><a href="#cb49-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-520"><a href="#cb49-520" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb49-521"><a href="#cb49-521" aria-hidden="true" tabindex="-1"></a>           <span class="st">"fltrd_tripData"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-522"><a href="#cb49-522" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">to_arrow</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-523"><a href="#cb49-523" aria-hidden="true" tabindex="-1"></a>    arrow<span class="sc">::</span><span class="fu">write_parquet</span>(<span class="at">sink =</span> <span class="st">"fltrdData/fltrd.parquet"</span>)</span>
<span id="cb49-524"><a href="#cb49-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-525"><a href="#cb49-525" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we have a filtered data file. </span></span>
<span id="cb49-526"><a href="#cb49-526" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">'tripdata'</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-527"><a href="#cb49-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-528"><a href="#cb49-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-531"><a href="#cb49-531" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-532"><a href="#cb49-532" aria-hidden="true" tabindex="-1"></a>duckdb<span class="sc">::</span><span class="fu">dbDisconnect</span>(dbconn, <span class="at">shutdown =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-533"><a href="#cb49-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-534"><a href="#cb49-534" aria-hidden="true" tabindex="-1"></a>tripset <span class="ot">&lt;-</span> arrow<span class="sc">::</span><span class="fu">open_dataset</span>(<span class="st">"fltrdData"</span>,</span>
<span id="cb49-535"><a href="#cb49-535" aria-hidden="true" tabindex="-1"></a>                               <span class="at">format =</span> <span class="st">"parquet"</span>)</span>
<span id="cb49-536"><a href="#cb49-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-537"><a href="#cb49-537" aria-hidden="true" tabindex="-1"></a>dbconn <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(duckdb<span class="sc">::</span><span class="fu">duckdb</span>())</span>
<span id="cb49-538"><a href="#cb49-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-539"><a href="#cb49-539" aria-hidden="true" tabindex="-1"></a><span class="co"># For querying the arrow dataset with the benefits of an OLAP database. </span></span>
<span id="cb49-540"><a href="#cb49-540" aria-hidden="true" tabindex="-1"></a>duckdb<span class="sc">::</span><span class="fu">duckdb_register_arrow</span>(dbconn,</span>
<span id="cb49-541"><a href="#cb49-541" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"fltrd_data"</span>,</span>
<span id="cb49-542"><a href="#cb49-542" aria-hidden="true" tabindex="-1"></a>                              tripset)</span>
<span id="cb49-543"><a href="#cb49-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-544"><a href="#cb49-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-547"><a href="#cb49-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-548"><a href="#cb49-548" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'rider count by hour table'</span></span>
<span id="cb49-549"><a href="#cb49-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-550"><a href="#cb49-550" aria-hidden="true" tabindex="-1"></a>hours_of_Riders <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb49-551"><a href="#cb49-551" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"fltrd_data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-552"><a href="#cb49-552" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(started_at) <span class="sc">|&gt;</span></span>
<span id="cb49-553"><a href="#cb49-553" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">"hour"</span> <span class="ot">=</span> lubridate<span class="sc">::</span><span class="fu">hour</span>(started_at)) <span class="sc">|&gt;</span></span>
<span id="cb49-554"><a href="#cb49-554" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(hour) <span class="sc">|&gt;</span></span>
<span id="cb49-555"><a href="#cb49-555" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="st">"riding"</span> <span class="ot">=</span> dplyr<span class="sc">::</span><span class="fu">count</span>(started_at)) <span class="sc">|&gt;</span></span>
<span id="cb49-556"><a href="#cb49-556" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(hour) <span class="sc">|&gt;</span></span>
<span id="cb49-557"><a href="#cb49-557" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-558"><a href="#cb49-558" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">"hour"</span> <span class="ot">=</span> hms<span class="sc">::</span><span class="fu">hms</span>(<span class="at">hours =</span> hour),</span>
<span id="cb49-559"><a href="#cb49-559" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"hour"</span> <span class="ot">=</span> <span class="fu">format</span>(<span class="fu">strptime</span>(hour, <span class="at">format =</span> <span class="st">"%H"</span>), <span class="st">"%r"</span>),</span>
<span id="cb49-560"><a href="#cb49-560" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"index"</span> <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>))</span>
<span id="cb49-561"><a href="#cb49-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-562"><a href="#cb49-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-563"><a href="#cb49-563" aria-hidden="true" tabindex="-1"></a>::: column-page</span>
<span id="cb49-566"><a href="#cb49-566" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-567"><a href="#cb49-567" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: 'radial-column plot'</span></span>
<span id="cb49-568"><a href="#cb49-568" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-column: page</span></span>
<span id="cb49-569"><a href="#cb49-569" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The time of day people tend to be riding."</span></span>
<span id="cb49-570"><a href="#cb49-570" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap-location: bottom</span></span>
<span id="cb49-571"><a href="#cb49-571" aria-hidden="true" tabindex="-1"></a><span class="co">#| title: "Time of Day and Volume of Cyclers"</span></span>
<span id="cb49-572"><a href="#cb49-572" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 15</span></span>
<span id="cb49-573"><a href="#cb49-573" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 12</span></span>
<span id="cb49-574"><a href="#cb49-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-575"><a href="#cb49-575" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> hours_of_Riders,</span>
<span id="cb49-576"><a href="#cb49-576" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb49-577"><a href="#cb49-577" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="fu">reorder</span>(hour, .data<span class="sc">$</span>index),</span>
<span id="cb49-578"><a href="#cb49-578" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> riding,</span>
<span id="cb49-579"><a href="#cb49-579" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill =</span> riding</span>
<span id="cb49-580"><a href="#cb49-580" aria-hidden="true" tabindex="-1"></a>                )) <span class="sc">+</span></span>
<span id="cb49-581"><a href="#cb49-581" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb49-582"><a href="#cb49-582" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">coord_radial</span>(<span class="at">start =</span> <span class="dv">2</span> <span class="sc">*</span> pi,</span>
<span id="cb49-583"><a href="#cb49-583" aria-hidden="true" tabindex="-1"></a>                          <span class="at">inner.radius =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb49-584"><a href="#cb49-584" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb49-585"><a href="#cb49-585" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb49-586"><a href="#cb49-586" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">'Spectral'</span>,</span>
<span id="cb49-587"><a href="#cb49-587" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb49-588"><a href="#cb49-588" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb49-589"><a href="#cb49-589" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Average Riders by the Hour of Day"</span>,</span>
<span id="cb49-590"><a href="#cb49-590" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"(Jan-Dec 2023)"</span>,</span>
<span id="cb49-591"><a href="#cb49-591" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Data from cyclistic database."</span>,</span>
<span id="cb49-592"><a href="#cb49-592" aria-hidden="true" tabindex="-1"></a>        <span class="at">tag =</span> <span class="st">"Figure 1.c"</span></span>
<span id="cb49-593"><a href="#cb49-593" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb49-594"><a href="#cb49-594" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb49-595"><a href="#cb49-595" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>,<span class="at">lineheight =</span> <span class="dv">4</span>),</span>
<span id="cb49-596"><a href="#cb49-596" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"white"</span>),</span>
<span id="cb49-597"><a href="#cb49-597" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> ggplot2<span class="sc">::</span><span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"black"</span>),</span>
<span id="cb49-598"><a href="#cb49-598" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> ggplot2<span class="sc">::</span><span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb49-599"><a href="#cb49-599" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> ggplot2<span class="sc">::</span><span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey10"</span>),</span>
<span id="cb49-600"><a href="#cb49-600" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> ggplot2<span class="sc">::</span><span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"black"</span>),</span>
<span id="cb49-601"><a href="#cb49-601" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb49-602"><a href="#cb49-602" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb49-603"><a href="#cb49-603" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb49-604"><a href="#cb49-604" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">color =</span> <span class="st">"grey90"</span>),</span>
<span id="cb49-605"><a href="#cb49-605" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> ggplot2<span class="sc">::</span><span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"black"</span>),</span>
<span id="cb49-606"><a href="#cb49-606" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.ticks =</span> ggplot2<span class="sc">::</span><span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb49-607"><a href="#cb49-607" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">linewidth =</span> .<span class="dv">5</span>),</span>
<span id="cb49-608"><a href="#cb49-608" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">'grey80'</span>,</span>
<span id="cb49-609"><a href="#cb49-609" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb49-610"><a href="#cb49-610" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb49-611"><a href="#cb49-611" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb49-612"><a href="#cb49-612" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">"center"</span>,</span>
<span id="cb49-613"><a href="#cb49-613" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">"vertical"</span></span>
<span id="cb49-614"><a href="#cb49-614" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-615"><a href="#cb49-615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-616"><a href="#cb49-616" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-617"><a href="#cb49-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-620"><a href="#cb49-620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-621"><a href="#cb49-621" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "column plot"</span></span>
<span id="cb49-622"><a href="#cb49-622" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: body-outset</span></span>
<span id="cb49-623"><a href="#cb49-623" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb49-624"><a href="#cb49-624" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb49-625"><a href="#cb49-625" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb49-626"><a href="#cb49-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-627"><a href="#cb49-627" aria-hidden="true" tabindex="-1"></a>memberCasuals_monthly  <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb49-628"><a href="#cb49-628" aria-hidden="true" tabindex="-1"></a>           <span class="st">"fltrd_data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-629"><a href="#cb49-629" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(started_at,</span>
<span id="cb49-630"><a href="#cb49-630" aria-hidden="true" tabindex="-1"></a>                  member_casual) <span class="sc">|&gt;</span></span>
<span id="cb49-631"><a href="#cb49-631" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">'month'</span> <span class="ot">=</span> lubridate<span class="sc">::</span><span class="fu">month</span>(started_at)) <span class="sc">|&gt;</span></span>
<span id="cb49-632"><a href="#cb49-632" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(month,</span>
<span id="cb49-633"><a href="#cb49-633" aria-hidden="true" tabindex="-1"></a>                    member_casual) <span class="sc">|&gt;</span></span>
<span id="cb49-634"><a href="#cb49-634" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="st">"riderCount"</span> <span class="ot">=</span> dplyr<span class="sc">::</span><span class="fu">count</span>(member_casual)) <span class="sc">|&gt;</span></span>
<span id="cb49-635"><a href="#cb49-635" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(month)</span>
<span id="cb49-636"><a href="#cb49-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-637"><a href="#cb49-637" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">collect</span>(memberCasuals_monthly) <span class="sc">|&gt;</span></span>
<span id="cb49-638"><a href="#cb49-638" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb49-639"><a href="#cb49-639" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_col</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(month),</span>
<span id="cb49-640"><a href="#cb49-640" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">y =</span> riderCount,</span>
<span id="cb49-641"><a href="#cb49-641" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">fill =</span> member_casual),</span>
<span id="cb49-642"><a href="#cb49-642" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb49-643"><a href="#cb49-643" aria-hidden="true" tabindex="-1"></a>                      <span class="at">position =</span> <span class="st">'dodge2'</span>) <span class="sc">+</span></span>
<span id="cb49-644"><a href="#cb49-644" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> month.abb,</span>
<span id="cb49-645"><a href="#cb49-645" aria-hidden="true" tabindex="-1"></a>                              <span class="at">name =</span> <span class="st">"Month"</span>) <span class="sc">+</span></span>
<span id="cb49-646"><a href="#cb49-646" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">'Set2'</span>) <span class="sc">+</span></span>
<span id="cb49-647"><a href="#cb49-647" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_dark</span>() <span class="sc">+</span></span>
<span id="cb49-648"><a href="#cb49-648" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb49-649"><a href="#cb49-649" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Monthly Ridership: Members vs Casuals"</span>,</span>
<span id="cb49-650"><a href="#cb49-650" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"(Jan-Dec 2023)"</span>,</span>
<span id="cb49-651"><a href="#cb49-651" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Data from cyclistic database."</span>,</span>
<span id="cb49-652"><a href="#cb49-652" aria-hidden="true" tabindex="-1"></a>    <span class="at">tag =</span> <span class="st">"Figure 1.b"</span>)</span>
<span id="cb49-653"><a href="#cb49-653" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-654"><a href="#cb49-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-655"><a href="#cb49-655" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualizations</span></span>
<span id="cb49-656"><a href="#cb49-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-657"><a href="#cb49-657" aria-hidden="true" tabindex="-1"></a>for quick reference with using Tsibble syntax</span>
<span id="cb49-658"><a href="#cb49-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-661"><a href="#cb49-661" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-662"><a href="#cb49-662" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'grouped tibb'</span></span>
<span id="cb49-663"><a href="#cb49-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-664"><a href="#cb49-664" aria-hidden="true" tabindex="-1"></a>grouped_byDay <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb49-665"><a href="#cb49-665" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"fltrd_data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-666"><a href="#cb49-666" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(started_at,</span>
<span id="cb49-667"><a href="#cb49-667" aria-hidden="true" tabindex="-1"></a>                  member_casual) <span class="sc">|&gt;</span></span>
<span id="cb49-668"><a href="#cb49-668" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-669"><a href="#cb49-669" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">started_at =</span> <span class="fu">as.Date</span>(started_at)) <span class="sc">|&gt;</span></span>
<span id="cb49-670"><a href="#cb49-670" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(started_at,</span>
<span id="cb49-671"><a href="#cb49-671" aria-hidden="true" tabindex="-1"></a>                    member_casual) <span class="sc">|&gt;</span></span>
<span id="cb49-672"><a href="#cb49-672" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb49-673"><a href="#cb49-673" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sdev =</span> stats<span class="sc">::</span><span class="fu">sd</span>(n))</span>
<span id="cb49-674"><a href="#cb49-674" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-675"><a href="#cb49-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-678"><a href="#cb49-678" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-679"><a href="#cb49-679" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'to grouped tsibb'</span></span>
<span id="cb49-680"><a href="#cb49-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-681"><a href="#cb49-681" aria-hidden="true" tabindex="-1"></a><span class="co"># tsibble, time-series table/tibble seems to make time series plots more straightforward</span></span>
<span id="cb49-682"><a href="#cb49-682" aria-hidden="true" tabindex="-1"></a>grouped_tsi <span class="ot">&lt;-</span> grouped_byDay <span class="sc">|&gt;</span></span>
<span id="cb49-683"><a href="#cb49-683" aria-hidden="true" tabindex="-1"></a>    tsibble<span class="sc">::</span><span class="fu">as_tsibble</span>(<span class="at">key =</span> <span class="fu">c</span>(member_casual,</span>
<span id="cb49-684"><a href="#cb49-684" aria-hidden="true" tabindex="-1"></a>                                n),</span>
<span id="cb49-685"><a href="#cb49-685" aria-hidden="true" tabindex="-1"></a>                        <span class="at">index =</span> started_at) <span class="sc">|&gt;</span></span>
<span id="cb49-686"><a href="#cb49-686" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(started_at)</span>
<span id="cb49-687"><a href="#cb49-687" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-688"><a href="#cb49-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-691"><a href="#cb49-691" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-692"><a href="#cb49-692" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: 'scatter plot'</span></span>
<span id="cb49-693"><a href="#cb49-693" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb49-694"><a href="#cb49-694" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb49-695"><a href="#cb49-695" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb49-696"><a href="#cb49-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-697"><a href="#cb49-697" aria-hidden="true" tabindex="-1"></a>grouped_tsi <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(</span>
<span id="cb49-698"><a href="#cb49-698" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> started_at, </span>
<span id="cb49-699"><a href="#cb49-699" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> n,</span>
<span id="cb49-700"><a href="#cb49-700" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> grouped_tsi<span class="sc">$</span>member_casual</span>
<span id="cb49-701"><a href="#cb49-701" aria-hidden="true" tabindex="-1"></a>                           )) <span class="sc">+</span></span>
<span id="cb49-702"><a href="#cb49-702" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb49-703"><a href="#cb49-703" aria-hidden="true" tabindex="-1"></a>                        <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb49-704"><a href="#cb49-704" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb49-705"><a href="#cb49-705" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Daily Count by Membership Type"</span>,</span>
<span id="cb49-706"><a href="#cb49-706" aria-hidden="true" tabindex="-1"></a>                  <span class="at">subtitle =</span> <span class="st">"2023"</span>,</span>
<span id="cb49-707"><a href="#cb49-707" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb49-708"><a href="#cb49-708" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="st">"Count"</span>)</span>
<span id="cb49-709"><a href="#cb49-709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-710"><a href="#cb49-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-713"><a href="#cb49-713" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-714"><a href="#cb49-714" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: "map query setup"</span></span>
<span id="cb49-715"><a href="#cb49-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-716"><a href="#cb49-716" aria-hidden="true" tabindex="-1"></a><span class="co"># chicago starting coordinates for leaflet, setView</span></span>
<span id="cb49-717"><a href="#cb49-717" aria-hidden="true" tabindex="-1"></a>chicago <span class="ot">&lt;-</span> maps<span class="sc">::</span>us.cities <span class="sc">|&gt;</span></span>
<span id="cb49-718"><a href="#cb49-718" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">"name"</span>,</span>
<span id="cb49-719"><a href="#cb49-719" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"long"</span>,</span>
<span id="cb49-720"><a href="#cb49-720" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"lat"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-721"><a href="#cb49-721" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">"Chicago IL"</span>)</span>
<span id="cb49-722"><a href="#cb49-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-723"><a href="#cb49-723" aria-hidden="true" tabindex="-1"></a><span class="co"># full dataset coordinates, might need to sample</span></span>
<span id="cb49-724"><a href="#cb49-724" aria-hidden="true" tabindex="-1"></a>coordQry <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb49-725"><a href="#cb49-725" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"fltrd_data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-726"><a href="#cb49-726" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(start_lng,</span>
<span id="cb49-727"><a href="#cb49-727" aria-hidden="true" tabindex="-1"></a>                  start_lat) <span class="sc">|&gt;</span></span>
<span id="cb49-728"><a href="#cb49-728" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">add_count</span>(start_lng,</span>
<span id="cb49-729"><a href="#cb49-729" aria-hidden="true" tabindex="-1"></a>                     start_lat) <span class="sc">|&gt;</span></span>
<span id="cb49-730"><a href="#cb49-730" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-731"><a href="#cb49-731" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb49-732"><a href="#cb49-732" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>()</span>
<span id="cb49-733"><a href="#cb49-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-734"><a href="#cb49-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-735"><a href="#cb49-735" aria-hidden="true" tabindex="-1"></a>coordQry_small <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb49-736"><a href="#cb49-736" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"fltrd_data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-737"><a href="#cb49-737" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(start_lng,</span>
<span id="cb49-738"><a href="#cb49-738" aria-hidden="true" tabindex="-1"></a>                  start_lat) <span class="sc">|&gt;</span></span>
<span id="cb49-739"><a href="#cb49-739" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">add_count</span>(start_lng,</span>
<span id="cb49-740"><a href="#cb49-740" aria-hidden="true" tabindex="-1"></a>                     start_lat) <span class="sc">|&gt;</span></span>
<span id="cb49-741"><a href="#cb49-741" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-742"><a href="#cb49-742" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb49-743"><a href="#cb49-743" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-744"><a href="#cb49-744" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">50</span>)</span>
<span id="cb49-745"><a href="#cb49-745" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-746"><a href="#cb49-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-749"><a href="#cb49-749" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-750"><a href="#cb49-750" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "leaflet"</span></span>
<span id="cb49-751"><a href="#cb49-751" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb49-752"><a href="#cb49-752" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb49-753"><a href="#cb49-753" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb49-754"><a href="#cb49-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-755"><a href="#cb49-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-756"><a href="#cb49-756" aria-hidden="true" tabindex="-1"></a>leaflet<span class="sc">::</span><span class="fu">leaflet</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-757"><a href="#cb49-757" aria-hidden="true" tabindex="-1"></a>    leaflet<span class="sc">::</span><span class="fu">addTiles</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-758"><a href="#cb49-758" aria-hidden="true" tabindex="-1"></a>    leaflet<span class="sc">::</span><span class="fu">setView</span>(<span class="at">lng =</span> chicago<span class="sc">$</span>long,</span>
<span id="cb49-759"><a href="#cb49-759" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lat =</span> chicago<span class="sc">$</span>lat,</span>
<span id="cb49-760"><a href="#cb49-760" aria-hidden="true" tabindex="-1"></a>                     <span class="at">zoom =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-761"><a href="#cb49-761" aria-hidden="true" tabindex="-1"></a>    leaflet<span class="sc">::</span><span class="fu">addMarkers</span>(<span class="at">lng =</span> coordQry<span class="sc">$</span>start_lng[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>],</span>
<span id="cb49-762"><a href="#cb49-762" aria-hidden="true" tabindex="-1"></a>                        <span class="at">lat =</span> coordQry<span class="sc">$</span>start_lat[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>],</span>
<span id="cb49-763"><a href="#cb49-763" aria-hidden="true" tabindex="-1"></a>                        <span class="at">clusterOptions =</span> leaflet<span class="sc">::</span><span class="fu">markerClusterOptions</span>())</span>
<span id="cb49-764"><a href="#cb49-764" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-765"><a href="#cb49-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-768"><a href="#cb49-768" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-769"><a href="#cb49-769" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: "mapview"</span></span>
<span id="cb49-770"><a href="#cb49-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-771"><a href="#cb49-771" aria-hidden="true" tabindex="-1"></a>coordQry_small <span class="sc">|&gt;</span></span>
<span id="cb49-772"><a href="#cb49-772" aria-hidden="true" tabindex="-1"></a>    sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>),</span>
<span id="cb49-773"><a href="#cb49-773" aria-hidden="true" tabindex="-1"></a>                <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-774"><a href="#cb49-774" aria-hidden="true" tabindex="-1"></a>    mapview<span class="sc">::</span><span class="fu">mapview</span>()</span>
<span id="cb49-775"><a href="#cb49-775" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-776"><a href="#cb49-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-779"><a href="#cb49-779" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-780"><a href="#cb49-780" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "tmap"</span></span>
<span id="cb49-781"><a href="#cb49-781" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb49-782"><a href="#cb49-782" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb49-783"><a href="#cb49-783" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb49-784"><a href="#cb49-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-785"><a href="#cb49-785" aria-hidden="true" tabindex="-1"></a>illi <span class="ot">&lt;-</span> <span class="fu">subset</span>(spData<span class="sc">::</span>us_states, NAME <span class="sc">==</span> <span class="st">"Illinois"</span>)</span>
<span id="cb49-786"><a href="#cb49-786" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tmap_mode</span>(<span class="st">"view"</span>)</span>
<span id="cb49-787"><a href="#cb49-787" aria-hidden="true" tabindex="-1"></a>coordQry_small <span class="sc">|&gt;</span></span>
<span id="cb49-788"><a href="#cb49-788" aria-hidden="true" tabindex="-1"></a>    sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>),</span>
<span id="cb49-789"><a href="#cb49-789" aria-hidden="true" tabindex="-1"></a>                 <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-790"><a href="#cb49-790" aria-hidden="true" tabindex="-1"></a>    tmap<span class="sc">::</span><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb49-791"><a href="#cb49-791" aria-hidden="true" tabindex="-1"></a>    tmap<span class="sc">::</span><span class="fu">tm_markers</span>(<span class="at">clustering =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb49-792"><a href="#cb49-792" aria-hidden="true" tabindex="-1"></a>    tmap<span class="sc">::</span><span class="fu">tm_basemap</span>(<span class="at">server =</span> <span class="fu">c</span>(<span class="st">'OpenStreetMap'</span>))</span>
<span id="cb49-793"><a href="#cb49-793" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-794"><a href="#cb49-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-797"><a href="#cb49-797" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-798"><a href="#cb49-798" aria-hidden="true" tabindex="-1"></a><span class="fu">ojs_define</span>(<span class="at">js_tsi =</span> grouped_tsi)</span>
<span id="cb49-799"><a href="#cb49-799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-800"><a href="#cb49-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-803"><a href="#cb49-803" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb49-804"><a href="#cb49-804" aria-hidden="true" tabindex="-1"></a><span class="in">jsData = transpose(js_tsi)</span></span>
<span id="cb49-805"><a href="#cb49-805" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-806"><a href="#cb49-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-807"><a href="#cb49-807" aria-hidden="true" tabindex="-1"></a>::: column-page</span>
<span id="cb49-810"><a href="#cb49-810" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb49-811"><a href="#cb49-811" aria-hidden="true" tabindex="-1"></a><span class="in">Plot.plot({</span></span>
<span id="cb49-812"><a href="#cb49-812" aria-hidden="true" tabindex="-1"></a><span class="in">    grid: true,</span></span>
<span id="cb49-813"><a href="#cb49-813" aria-hidden="true" tabindex="-1"></a><span class="in">    color: {legend: true},</span></span>
<span id="cb49-814"><a href="#cb49-814" aria-hidden="true" tabindex="-1"></a><span class="in">    marks: [</span></span>
<span id="cb49-815"><a href="#cb49-815" aria-hidden="true" tabindex="-1"></a><span class="in">        Plot.dot(jsData, {x: 'started_at', y: 'n', fill: 'member_casual'})</span></span>
<span id="cb49-816"><a href="#cb49-816" aria-hidden="true" tabindex="-1"></a><span class="in">]</span></span>
<span id="cb49-817"><a href="#cb49-817" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb49-818"><a href="#cb49-818" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-819"><a href="#cb49-819" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-822"><a href="#cb49-822" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb49-823"><a href="#cb49-823" aria-hidden="true" tabindex="-1"></a><span class="in">Plot.lineY(jsData, {x: "started_at", y: "n"}).plot()</span></span>
<span id="cb49-824"><a href="#cb49-824" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-825"><a href="#cb49-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-828"><a href="#cb49-828" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb49-829"><a href="#cb49-829" aria-hidden="true" tabindex="-1"></a><span class="in">Inputs.table(jsData, {</span></span>
<span id="cb49-830"><a href="#cb49-830" aria-hidden="true" tabindex="-1"></a><span class="in">rows: 20</span></span>
<span id="cb49-831"><a href="#cb49-831" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb49-832"><a href="#cb49-832" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-833"><a href="#cb49-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-836"><a href="#cb49-836" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-837"><a href="#cb49-837" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: 'line plot'</span></span>
<span id="cb49-838"><a href="#cb49-838" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb49-839"><a href="#cb49-839" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb49-840"><a href="#cb49-840" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb49-841"><a href="#cb49-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-842"><a href="#cb49-842" aria-hidden="true" tabindex="-1"></a>grouped_tsi <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(</span>
<span id="cb49-843"><a href="#cb49-843" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> started_at, </span>
<span id="cb49-844"><a href="#cb49-844" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> n,</span>
<span id="cb49-845"><a href="#cb49-845" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> grouped_tsi<span class="sc">$</span>member_casual</span>
<span id="cb49-846"><a href="#cb49-846" aria-hidden="true" tabindex="-1"></a>                           )) <span class="sc">+</span></span>
<span id="cb49-847"><a href="#cb49-847" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">'align'</span>,</span>
<span id="cb49-848"><a href="#cb49-848" aria-hidden="true" tabindex="-1"></a>                       <span class="at">lineend =</span> <span class="st">'round'</span>,</span>
<span id="cb49-849"><a href="#cb49-849" aria-hidden="true" tabindex="-1"></a>                       <span class="at">linejoin =</span> <span class="st">'mitre'</span>,</span>
<span id="cb49-850"><a href="#cb49-850" aria-hidden="true" tabindex="-1"></a>                       <span class="at">linewidth =</span> .<span class="dv">5</span>,</span>
<span id="cb49-851"><a href="#cb49-851" aria-hidden="true" tabindex="-1"></a>                       <span class="at">alpha =</span> .<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb49-852"><a href="#cb49-852" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb49-853"><a href="#cb49-853" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Daily Count by Membership Type"</span>,</span>
<span id="cb49-854"><a href="#cb49-854" aria-hidden="true" tabindex="-1"></a>                  <span class="at">subtitle =</span> <span class="st">"2023"</span>,</span>
<span id="cb49-855"><a href="#cb49-855" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">"Year-Month"</span>,</span>
<span id="cb49-856"><a href="#cb49-856" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="st">"Count"</span>)</span>
<span id="cb49-857"><a href="#cb49-857" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-858"><a href="#cb49-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-861"><a href="#cb49-861" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-862"><a href="#cb49-862" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: 'area plot'</span></span>
<span id="cb49-863"><a href="#cb49-863" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: body-outset</span></span>
<span id="cb49-864"><a href="#cb49-864" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb49-865"><a href="#cb49-865" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb49-866"><a href="#cb49-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-867"><a href="#cb49-867" aria-hidden="true" tabindex="-1"></a>grouped_tsi <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(</span>
<span id="cb49-868"><a href="#cb49-868" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> started_at, </span>
<span id="cb49-869"><a href="#cb49-869" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> n,</span>
<span id="cb49-870"><a href="#cb49-870" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill =</span> grouped_tsi<span class="sc">$</span>member_casual)) <span class="sc">+</span></span>
<span id="cb49-871"><a href="#cb49-871" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb49-872"><a href="#cb49-872" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">"month"</span>,</span>
<span id="cb49-873"><a href="#cb49-873" aria-hidden="true" tabindex="-1"></a>                          <span class="at">minor_breaks =</span> <span class="st">"day"</span>,</span>
<span id="cb49-874"><a href="#cb49-874" aria-hidden="true" tabindex="-1"></a>                          <span class="at">date_labels =</span> <span class="st">"%b"</span>) <span class="sc">+</span></span>
<span id="cb49-875"><a href="#cb49-875" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb49-876"><a href="#cb49-876" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Daily Count by Membership Type"</span>,</span>
<span id="cb49-877"><a href="#cb49-877" aria-hidden="true" tabindex="-1"></a>                  <span class="at">subtitle =</span> <span class="st">"2023"</span>,</span>
<span id="cb49-878"><a href="#cb49-878" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb49-879"><a href="#cb49-879" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="st">"Count"</span>)</span>
<span id="cb49-880"><a href="#cb49-880" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-881"><a href="#cb49-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-884"><a href="#cb49-884" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-885"><a href="#cb49-885" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: 'histogram plot'</span></span>
<span id="cb49-886"><a href="#cb49-886" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb49-887"><a href="#cb49-887" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb49-888"><a href="#cb49-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-889"><a href="#cb49-889" aria-hidden="true" tabindex="-1"></a><span class="co"># query for the histogram plot</span></span>
<span id="cb49-890"><a href="#cb49-890" aria-hidden="true" tabindex="-1"></a>qry4_histo <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb49-891"><a href="#cb49-891" aria-hidden="true" tabindex="-1"></a>           <span class="st">"fltrd_data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-892"><a href="#cb49-892" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(started_at, member_casual) <span class="sc">|&gt;</span></span>
<span id="cb49-893"><a href="#cb49-893" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-894"><a href="#cb49-894" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">started_at =</span> <span class="fu">as.Date</span>(started_at)) <span class="sc">|&gt;</span></span>
<span id="cb49-895"><a href="#cb49-895" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(member_casual) <span class="sc">|&gt;</span></span>
<span id="cb49-896"><a href="#cb49-896" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(started_at)</span>
<span id="cb49-897"><a href="#cb49-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-898"><a href="#cb49-898" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram plot</span></span>
<span id="cb49-899"><a href="#cb49-899" aria-hidden="true" tabindex="-1"></a>qry4_histo <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(</span>
<span id="cb49-900"><a href="#cb49-900" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> started_at, </span>
<span id="cb49-901"><a href="#cb49-901" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill =</span> qry4_histo<span class="sc">$</span>member_casual)) <span class="sc">+</span></span>
<span id="cb49-902"><a href="#cb49-902" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb49-903"><a href="#cb49-903" aria-hidden="true" tabindex="-1"></a>                            <span class="at">bins =</span> <span class="dv">365</span></span>
<span id="cb49-904"><a href="#cb49-904" aria-hidden="true" tabindex="-1"></a>                            ) <span class="sc">+</span></span>
<span id="cb49-905"><a href="#cb49-905" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">"1 month"</span>,</span>
<span id="cb49-906"><a href="#cb49-906" aria-hidden="true" tabindex="-1"></a>                          <span class="at">date_minor_breaks =</span> <span class="st">'days'</span>,</span>
<span id="cb49-907"><a href="#cb49-907" aria-hidden="true" tabindex="-1"></a>                          <span class="at">date_labels =</span> <span class="st">"%b"</span>) <span class="sc">+</span></span>
<span id="cb49-908"><a href="#cb49-908" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb49-909"><a href="#cb49-909" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Daily Count by Membership Type"</span>,</span>
<span id="cb49-910"><a href="#cb49-910" aria-hidden="true" tabindex="-1"></a>                  <span class="at">subtitle =</span> <span class="st">"2023"</span>,</span>
<span id="cb49-911"><a href="#cb49-911" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">"Months"</span>,</span>
<span id="cb49-912"><a href="#cb49-912" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="st">"Count"</span>)</span>
<span id="cb49-913"><a href="#cb49-913" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-914"><a href="#cb49-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-917"><a href="#cb49-917" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-918"><a href="#cb49-918" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'grouped stats tibb'</span></span>
<span id="cb49-919"><a href="#cb49-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-920"><a href="#cb49-920" aria-hidden="true" tabindex="-1"></a><span class="co"># Need a useful data frame for basic aggregations</span></span>
<span id="cb49-921"><a href="#cb49-921" aria-hidden="true" tabindex="-1"></a>groupedStats_byDay <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tbl</span>(dbconn,</span>
<span id="cb49-922"><a href="#cb49-922" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"fltrd_data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-923"><a href="#cb49-923" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(started_at,</span>
<span id="cb49-924"><a href="#cb49-924" aria-hidden="true" tabindex="-1"></a>                  member_casual,</span>
<span id="cb49-925"><a href="#cb49-925" aria-hidden="true" tabindex="-1"></a>                  rideable_type,</span>
<span id="cb49-926"><a href="#cb49-926" aria-hidden="true" tabindex="-1"></a>                  trip_time,</span>
<span id="cb49-927"><a href="#cb49-927" aria-hidden="true" tabindex="-1"></a>                  miles,</span>
<span id="cb49-928"><a href="#cb49-928" aria-hidden="true" tabindex="-1"></a>                  mph) <span class="sc">|&gt;</span></span>
<span id="cb49-929"><a href="#cb49-929" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-930"><a href="#cb49-930" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">started_at =</span> <span class="fu">as.Date</span>(started_at)) <span class="sc">|&gt;</span></span>
<span id="cb49-931"><a href="#cb49-931" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(started_at,</span>
<span id="cb49-932"><a href="#cb49-932" aria-hidden="true" tabindex="-1"></a>                    member_casual,</span>
<span id="cb49-933"><a href="#cb49-933" aria-hidden="true" tabindex="-1"></a>                    rideable_type) <span class="sc">|&gt;</span></span>
<span id="cb49-934"><a href="#cb49-934" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb49-935"><a href="#cb49-935" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trip_time_Mean =</span> <span class="fu">mean</span>(trip_time),</span>
<span id="cb49-936"><a href="#cb49-936" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trip_time_stDev =</span> stats<span class="sc">::</span><span class="fu">sd</span>(trip_time),</span>
<span id="cb49-937"><a href="#cb49-937" aria-hidden="true" tabindex="-1"></a>                     <span class="at">miles_Mean =</span> <span class="fu">mean</span>(miles),</span>
<span id="cb49-938"><a href="#cb49-938" aria-hidden="true" tabindex="-1"></a>                     <span class="at">miles_stDev =</span> stats<span class="sc">::</span><span class="fu">sd</span>(miles),</span>
<span id="cb49-939"><a href="#cb49-939" aria-hidden="true" tabindex="-1"></a>                     <span class="at">mph_Mean =</span> <span class="fu">mean</span>(miles),</span>
<span id="cb49-940"><a href="#cb49-940" aria-hidden="true" tabindex="-1"></a>                     <span class="at">mph_stDev =</span> stats<span class="sc">::</span><span class="fu">sd</span>(mph))</span>
<span id="cb49-941"><a href="#cb49-941" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-942"><a href="#cb49-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-945"><a href="#cb49-945" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-946"><a href="#cb49-946" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'grouped stats tsibb'</span></span>
<span id="cb49-947"><a href="#cb49-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-948"><a href="#cb49-948" aria-hidden="true" tabindex="-1"></a><span class="co"># Would prefer to work with a tsibble for time-series data</span></span>
<span id="cb49-949"><a href="#cb49-949" aria-hidden="true" tabindex="-1"></a>groupedStats_tsib <span class="ot">&lt;-</span> groupedStats_byDay <span class="sc">|&gt;</span></span>
<span id="cb49-950"><a href="#cb49-950" aria-hidden="true" tabindex="-1"></a>    tsibble<span class="sc">::</span><span class="fu">as_tsibble</span>(<span class="at">key =</span> <span class="fu">c</span>(member_casual<span class="sc">:</span>mph_stDev),</span>
<span id="cb49-951"><a href="#cb49-951" aria-hidden="true" tabindex="-1"></a>                        <span class="at">index =</span> started_at) <span class="sc">|&gt;</span></span>
<span id="cb49-952"><a href="#cb49-952" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(started_at)</span>
<span id="cb49-953"><a href="#cb49-953" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-954"><a href="#cb49-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-957"><a href="#cb49-957" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-958"><a href="#cb49-958" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb49-959"><a href="#cb49-959" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: 'Ribbon-Line Plot'</span></span>
<span id="cb49-960"><a href="#cb49-960" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb49-961"><a href="#cb49-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-962"><a href="#cb49-962" aria-hidden="true" tabindex="-1"></a>groupedStats_tsib <span class="sc">|&gt;</span> </span>
<span id="cb49-963"><a href="#cb49-963" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(started_at,</span>
<span id="cb49-964"><a href="#cb49-964" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">group =</span>  rideable_type)) <span class="sc">+</span></span>
<span id="cb49-965"><a href="#cb49-965" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>,</span>
<span id="cb49-966"><a href="#cb49-966" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb49-967"><a href="#cb49-967" aria-hidden="true" tabindex="-1"></a>            <span class="at">ymin =</span> (groupedStats_tsib<span class="sc">$</span>trip_time_Mean <span class="sc">-</span></span>
<span id="cb49-968"><a href="#cb49-968" aria-hidden="true" tabindex="-1"></a>                groupedStats_tsib<span class="sc">$</span>miles_stDev),</span>
<span id="cb49-969"><a href="#cb49-969" aria-hidden="true" tabindex="-1"></a>            <span class="at">ymax =</span> (groupedStats_tsib<span class="sc">$</span>trip_time_Mean <span class="sc">+</span></span>
<span id="cb49-970"><a href="#cb49-970" aria-hidden="true" tabindex="-1"></a>                groupedStats_tsib<span class="sc">$</span>miles_stDev)),</span>
<span id="cb49-971"><a href="#cb49-971" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fill =</span> <span class="st">'white'</span>) <span class="sc">+</span></span>
<span id="cb49-972"><a href="#cb49-972" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> trip_time_Mean,</span>
<span id="cb49-973"><a href="#cb49-973" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">color =</span> rideable_type),</span>
<span id="cb49-974"><a href="#cb49-974" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb49-975"><a href="#cb49-975" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">'%B'</span>,</span>
<span id="cb49-976"><a href="#cb49-976" aria-hidden="true" tabindex="-1"></a>                          <span class="at">date_minor_breaks =</span> <span class="st">'days'</span>,</span>
<span id="cb49-977"><a href="#cb49-977" aria-hidden="true" tabindex="-1"></a>                          <span class="at">limits =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">'2023-01-01'</span>, <span class="st">'2024-01-01'</span>))) <span class="sc">+</span></span>
<span id="cb49-978"><a href="#cb49-978" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">'Pastel1'</span>) <span class="sc">+</span></span>
<span id="cb49-979"><a href="#cb49-979" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_dark</span>()</span>
<span id="cb49-980"><a href="#cb49-980" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-981"><a href="#cb49-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-984"><a href="#cb49-984" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-985"><a href="#cb49-985" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: 'Facet-Wrap Plot'</span></span>
<span id="cb49-986"><a href="#cb49-986" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb49-987"><a href="#cb49-987" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 14</span></span>
<span id="cb49-988"><a href="#cb49-988" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 12</span></span>
<span id="cb49-989"><a href="#cb49-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-990"><a href="#cb49-990" aria-hidden="true" tabindex="-1"></a><span class="co"># A solution to help visualize these mutli-dimensional relationships of membership and bike type to time.</span></span>
<span id="cb49-991"><a href="#cb49-991" aria-hidden="true" tabindex="-1"></a>groupedStats_tsib <span class="sc">|&gt;</span></span>
<span id="cb49-992"><a href="#cb49-992" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> started_at,</span>
<span id="cb49-993"><a href="#cb49-993" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> trip_time_Mean,</span>
<span id="cb49-994"><a href="#cb49-994" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">color =</span> trip_time_Mean)) <span class="sc">+</span></span>
<span id="cb49-995"><a href="#cb49-995" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_count</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb49-996"><a href="#cb49-996" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>member_casual<span class="sc">+</span>rideable_type) <span class="sc">+</span></span>
<span id="cb49-997"><a href="#cb49-997" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_x_date</span>(<span class="at">date_minor_breaks =</span> <span class="st">"days"</span>,</span>
<span id="cb49-998"><a href="#cb49-998" aria-hidden="true" tabindex="-1"></a>                          <span class="at">date_labels =</span> <span class="st">"%b"</span>,</span>
<span id="cb49-999"><a href="#cb49-999" aria-hidden="true" tabindex="-1"></a>                          <span class="at">breaks =</span> <span class="st">"months"</span>) <span class="sc">+</span></span>
<span id="cb49-1000"><a href="#cb49-1000" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">axis.text.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,</span>
<span id="cb49-1001"><a href="#cb49-1001" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb49-1002"><a href="#cb49-1002" aria-hidden="true" tabindex="-1"></a>                   <span class="at">panel.background =</span> ggplot2<span class="sc">::</span><span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'grey20'</span>),</span>
<span id="cb49-1003"><a href="#cb49-1003" aria-hidden="true" tabindex="-1"></a>                   <span class="at">panel.grid.major.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_line</span>(</span>
<span id="cb49-1004"><a href="#cb49-1004" aria-hidden="true" tabindex="-1"></a>                       <span class="at">linetype =</span> <span class="st">'dashed'</span>,</span>
<span id="cb49-1005"><a href="#cb49-1005" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="st">'grey30'</span>),</span>
<span id="cb49-1006"><a href="#cb49-1006" aria-hidden="true" tabindex="-1"></a>                   <span class="at">panel.grid.major.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_line</span>(</span>
<span id="cb49-1007"><a href="#cb49-1007" aria-hidden="true" tabindex="-1"></a>                       <span class="at">linetype =</span> <span class="st">'dotted'</span>,</span>
<span id="cb49-1008"><a href="#cb49-1008" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="st">'grey30'</span>),</span>
<span id="cb49-1009"><a href="#cb49-1009" aria-hidden="true" tabindex="-1"></a>                   <span class="at">panel.grid.minor =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb49-1010"><a href="#cb49-1010" aria-hidden="true" tabindex="-1"></a>                   <span class="at">strip.background.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_rect</span>(</span>
<span id="cb49-1011"><a href="#cb49-1011" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> <span class="st">'yellowgreen'</span>)) <span class="sc">+</span></span>
<span id="cb49-1012"><a href="#cb49-1012" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">'Spectral'</span>)</span>
<span id="cb49-1013"><a href="#cb49-1013" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1014"><a href="#cb49-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1017"><a href="#cb49-1017" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-1018"><a href="#cb49-1018" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: "dygraph"</span></span>
<span id="cb49-1019"><a href="#cb49-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1020"><a href="#cb49-1020" aria-hidden="true" tabindex="-1"></a>sumDF <span class="ot">&lt;-</span> groupedStats_byDay <span class="sc">|&gt;</span></span>
<span id="cb49-1021"><a href="#cb49-1021" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(started_at,</span>
<span id="cb49-1022"><a href="#cb49-1022" aria-hidden="true" tabindex="-1"></a>                  n) <span class="sc">|&gt;</span></span>
<span id="cb49-1023"><a href="#cb49-1023" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(started_at,</span>
<span id="cb49-1024"><a href="#cb49-1024" aria-hidden="true" tabindex="-1"></a>                    member_casual) <span class="sc">|&gt;</span></span>
<span id="cb49-1025"><a href="#cb49-1025" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="st">"count"</span> <span class="ot">=</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb49-1026"><a href="#cb49-1026" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> member_casual,</span>
<span id="cb49-1027"><a href="#cb49-1027" aria-hidden="true" tabindex="-1"></a>                       <span class="at">values_from =</span> count)</span>
<span id="cb49-1028"><a href="#cb49-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1029"><a href="#cb49-1029" aria-hidden="true" tabindex="-1"></a>dygraphs<span class="sc">::</span><span class="fu">dygraph</span>(sumDF, <span class="at">main =</span> <span class="st">"ever"</span>,</span>
<span id="cb49-1030"><a href="#cb49-1030" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab =</span> <span class="st">"what"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-1031"><a href="#cb49-1031" aria-hidden="true" tabindex="-1"></a>    dygraphs<span class="sc">::</span><span class="fu">dyGroup</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">"member"</span>, <span class="st">"casual"</span>),</span>
<span id="cb49-1032"><a href="#cb49-1032" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"red"</span>))</span>
<span id="cb49-1033"><a href="#cb49-1033" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1034"><a href="#cb49-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1035"><a href="#cb49-1035" aria-hidden="true" tabindex="-1"></a>These maps track bike-sharing activity going on worldwide and in Chicago.</span>
<span id="cb49-1036"><a href="#cb49-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1037"><a href="#cb49-1037" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Bike Share Map</span><span class="co">](https://bikesharemap.com/#/8/-87.5771/41.3747/)</span> <span class="co">[</span><span class="ot">@bikesha</span><span class="co">]</span></span>
<span id="cb49-1038"><a href="#cb49-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1039"><a href="#cb49-1039" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">CityBikes: bike sharing networks around the world</span><span class="co">](https://citybik.es/)</span> <span class="co">[</span><span class="ot">@citybike</span><span class="co">]</span></span>
<span id="cb49-1040"><a href="#cb49-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1041"><a href="#cb49-1041" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb49-1042"><a href="#cb49-1042" aria-hidden="true" tabindex="-1"></a><span class="in">#|label: 'drops duckDB tables'</span></span>
<span id="cb49-1043"><a href="#cb49-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1044"><a href="#cb49-1044" aria-hidden="true" tabindex="-1"></a><span class="in"># a chunk for easily dropping either all (default) or specific tables from the ddb. Also made it so you can see the current tables and then the tables after running the chunk.</span></span>
<span id="cb49-1045"><a href="#cb49-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1046"><a href="#cb49-1046" aria-hidden="true" tabindex="-1"></a><span class="in">paths &lt;- duckdb::dbListTables(dbconn)</span></span>
<span id="cb49-1047"><a href="#cb49-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1048"><a href="#cb49-1048" aria-hidden="true" tabindex="-1"></a><span class="in">paths[]</span></span>
<span id="cb49-1049"><a href="#cb49-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1050"><a href="#cb49-1050" aria-hidden="true" tabindex="-1"></a><span class="in">drops_tables &lt;- function(path) {</span></span>
<span id="cb49-1051"><a href="#cb49-1051" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb49-1052"><a href="#cb49-1052" aria-hidden="true" tabindex="-1"></a><span class="in">    duckdb::dbRemoveTable(dbconn, </span></span>
<span id="cb49-1053"><a href="#cb49-1053" aria-hidden="true" tabindex="-1"></a><span class="in">                          path)</span></span>
<span id="cb49-1054"><a href="#cb49-1054" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb49-1055"><a href="#cb49-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1056"><a href="#cb49-1056" aria-hidden="true" tabindex="-1"></a><span class="in">paths[] |&gt; purrr::walk(drops_tables)</span></span>
<span id="cb49-1057"><a href="#cb49-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1058"><a href="#cb49-1058" aria-hidden="true" tabindex="-1"></a><span class="in">paths &lt;- duckdb::dbListTables(dbconn)</span></span>
<span id="cb49-1059"><a href="#cb49-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1060"><a href="#cb49-1060" aria-hidden="true" tabindex="-1"></a><span class="in">paths[]</span></span>
<span id="cb49-1061"><a href="#cb49-1061" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1062"><a href="#cb49-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1065"><a href="#cb49-1065" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-1066"><a href="#cb49-1066" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: 'duckDB Shutdown'</span></span>
<span id="cb49-1067"><a href="#cb49-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1068"><a href="#cb49-1068" aria-hidden="true" tabindex="-1"></a>duckdb<span class="sc">::</span><span class="fu">dbDisconnect</span>(dbconn, <span class="at">shutdown =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-1069"><a href="#cb49-1069" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1070"><a href="#cb49-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1073"><a href="#cb49-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-1074"><a href="#cb49-1074" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">"fltrdData"</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-1075"><a href="#cb49-1075" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>